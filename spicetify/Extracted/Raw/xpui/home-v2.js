"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[7704],{89090:(e,t,n)=>{n.r(t),n.d(t,{SKELETON_CARDS_COUNT:()=>wt,SKELETON_SHELVES_COUNT:()=>Et,SKELETON_SHORTCUTS_COUNT:()=>bt,default:()=>Bt});var s=n(59496),a=n(84875),i=n.n(a),o=n(61740),r=n(6948),c=n(20619),l=n(14950),u=n(54353),m=n(17070),d=n(70293),h=n(60281),x=n(18113),g=n(87367),j=n(50313),p=n(42135),f=n(14319),y=n(38881),v=n(63459),S=n(68635),C=n(16014),N=n(75814),_=n(69194),k=n(34604),P=n(99494),b=n(48719),E=n(90882);const w="view-homeShortcutsGrid-shortcuts",T="view-homeShortcutsGrid-grid",L="view-homeShortcutsGrid-shortcutLink",B="view-homeShortcutsGrid-shortcut",I="view-homeShortcutsGrid-draggable",F="view-homeShortcutsGrid-imageContainer",M="view-homeShortcutsGrid-imageWrapper",O="view-homeShortcutsGrid-image",U="view-homeShortcutsGrid-main",A="view-homeShortcutsGrid-nameWrapper",D="view-homeShortcutsGrid-name",H="EzRmGRncgnv1zFgF4dqE",J="bPmmKmSPLKMhtJSaUJRX",$="vpQWUBWS_lXRLZMRJT7w",R="GSv7K805J9Jw7LB9tn2A",W="view-homeShortcutsGrid-PlayButtonContainer",z="s9c9x_mJq197U2hBzGtV";var G=n(4637);const q=(0,s.memo)((function({item:e}){const t=(0,P._)(e.uri),n=e.duration_ms??0,{isPlaying:s,isActive:a}=(0,E.$o)(e.uri),[i]=(0,b.z)(1e4,(t=>t.item?.uri===e.uri)),o=e.resume_point?.resume_position_ms??0,r=s||a?i:o,c=Math.round(100/(n/r)),l=t===k.Om.YES,u=n&&r>0;return l||u?(0,G.jsxs)("div",{className:$,children:[l?(0,G.jsx)(N.E,{iconSize:16,semanticColor:"textSubdued"}):null,u?(0,G.jsx)(_.k,{className:R,value:c,semanticColor:"essentialBase"}):null]}):null}));var Y=n(92053),Z=n(46810),K=n(83336),V=n(95804),X=n(35026),Q=n(66072),ee=n(28564),te=n(35387),ne=n(69544),se=n(20251),ae=n(70103),ie=n(60470);const oe=(0,s.memo)((function({images:e=[],fallbackIcon:t=j.U}){const n=(0,ie.X)(e);return(0,G.jsx)("div",{className:F,children:(0,G.jsx)("div",{className:M,children:(0,G.jsx)(ae.E,{className:O,src:n?.url,loading:"lazy",testid:"shortcut-image",children:(0,G.jsx)(t,{"aria-hidden":!0})})})})}));var re=n(25947),ce=n(49340),le=n(89396);const ue=s.memo((function({index:e,item:t,fallbackIcon:n,showPlayButton:a,extraContent:r,playInsteadOfNavigating:c=!1,onContextMenu:u=(()=>{}),onTouchStart:m=(()=>{}),onTouchEnd:d=(()=>{})}){const h=(0,Y.s0)(),x=(0,ce.o)(),{setColorFromUri:j,resetColor:p,clearColor:f}=(0,g.WQ)(),y=(0,Q.G3)(t.uri,t.release_date,t.resume_point?.resume_position_ms,t.resume_point?.fully_played),{spec:S,logger:C}=(0,ne.fU)(K.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:N,isActive:_,togglePlay:k}=(0,te.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"}),P=(0,v.EC)(t.uri),b=P?.type,E=(0,o.v9)(V.br),w=(0,o.v9)(V.yE),T=l.ag.getLocale(),F=(0,se.S9)({localeFeatureFlag:E,entityFeatureFlag:w,locale:T,entity:b,type:"link"}),M=(0,s.useCallback)((()=>{x({targetUri:t.uri,intent:N?"pause":"play",type:"click"});const e=S.playButtonFactory();let n;n=N?e.hitPause({itemToBePaused:t.uri}):_?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri});const s=C.logInteraction(n);k({loggingParams:s})}),[_,N,t.uri,C,x,S,k]),O=(0,s.useCallback)((()=>{if(c)return void M();x({targetUri:t.uri,intent:"navigate",type:"click"});const e=S.hitUiNavigate({destination:t.uri});let n;C.logInteraction(e),P&&(n=P.toURLPath(!0));const s=F?`/${ee.F0}${T}${n}`:n;s&&h(s)}),[t.uri,C,h,x,S,P,F,T,c,M]),$=(0,s.useCallback)((()=>{j(t.uri)}),[t.uri,j]);(0,s.useEffect)((()=>()=>{f()}),[f]);const R=(0,ne.Wi)(S),q=(0,re.O1)([t.uri],t.name);return(0,G.jsx)("div",{ref:R,className:B,onContextMenu:u,onTouchStart:m,onTouchEnd:d,onMouseEnter:$,onMouseLeave:p,children:(0,G.jsxs)("div",{className:I,onDragStart:q,children:[(0,G.jsx)(oe,{images:t.images,fallbackIcon:n}),(0,G.jsxs)("div",{className:U,children:[(0,G.jsxs)("div",{className:A,children:[(0,G.jsxs)("div",{className:D,children:[y&&(0,G.jsx)(Q.Rd,{className:J}),(0,G.jsx)(le.Link,{to:t.uri,onClick:O,title:t.name,children:(0,G.jsx)(Z.D,{as:"p",variant:"balladBold",className:H,children:t.name})})]}),r||null]}),a&&(0,G.jsx)("div",{className:i()(W,{[z]:N}),children:(0,G.jsx)(X.f,{isPlaying:N,onClick:M})})]}),(0,G.jsx)("div",{onClick:O,className:L})]})})}));var me=n(98816),de=n(78724),he=n(91261),xe=n(72192),ge=n(12116);const je=s.memo((function(e){return(0,v.zO)(e.item.uri)?(0,G.jsx)(ue,{...e,fallbackIcon:j.U}):(0,S.MW)(e.item.uri)?(0,G.jsx)(C._,{menu:(0,G.jsx)(S.XL,{}),children:(0,G.jsx)(ue,{...e,fallbackIcon:j.U,playInsteadOfNavigating:!0})}):(0,G.jsx)(C._,{menu:(0,G.jsx)(xe.X,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:j.U})})})),pe=s.memo((function(e){return(0,G.jsx)(C._,{menu:(0,G.jsx)(me.Y,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:p.c})})})),fe=s.memo((function(e){return(0,G.jsx)(C._,{menu:(0,G.jsx)(de.m,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:f.a})})})),ye=s.memo((function(e){return(0,G.jsx)(C._,{menu:(0,G.jsx)(ge.M,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:y.J,showPlayButton:!1})})})),ve=s.memo((function(e){return e.item.podcast?(0,G.jsx)(ye,{index:e.index,shouldSetBackgroundColor:e.shouldSetBackgroundColor,item:e.item.podcast,showPlayButton:e.showPlayButton}):(0,G.jsx)(C._,{menu:(0,G.jsx)(he.k,{uri:e.item.uri}),children:(0,G.jsx)(ue,{...e,fallbackIcon:y.J,extraContent:(0,G.jsx)(q,{...e})})})}));var Se=n(68003),Ce=n(19444);const Ne="J6UEDIqMSJhYlwGoeUZB",_e="ZjFf4lVC48DSryAjP9qB",ke=s.memo((function(e){const t=(0,Ce.x)(),n={...e.item,...t};return(0,G.jsx)(ue,{...e,item:n,fallbackIcon:()=>(0,G.jsx)("div",{className:Ne,children:(0,G.jsx)(Se.P,{iconSize:32,className:_e})})})}));var Pe=n(22646),be=n(18914);const Ee=24,we=270,Te=200,Le=600,Be=3*we+2*Ee,Ie=80,Fe=64,Me=16,Oe=12;function Ue(e){if(null===e)return{cssProperties:{"--min-column-width":`${we}px`,"--item-height":`${Ie}px`,"--column-gap":`${Ee}px`,"--row-gap":`${Me}px`},showPlayButton:!0};const t=e.offsetWidth,n=t<Le?Te:we;const s=Math.min(Math.floor((t+Ee)/(n+Ee)),3),a=t>=Be?Ie:Fe;return{cssProperties:{"--min-column-width":`${n}px`,"--item-height":`${a}px`,"--column-gap":`${Ee}px`,"--row-gap":`${a===Fe?Oe:Me}px`},showPlayButton:(t-(s-1)*Ee)/s>=we}}function Ae(){const e=(0,s.useRef)(null),[t,n]=(0,s.useState)(Ue(null)),a=(0,s.useCallback)((()=>{null!==e.current&&n(Ue(e.current))}),[]),i=(0,s.useCallback)((t=>{e.current=t,a()}),[a]);return(0,d.a)((()=>a())),[t,i]}const De=e=>{if(null!==e&&"object"==typeof e){const{type:t,name:n}=e;return t===x.p.YOUR_EPISODES&&"string"==typeof n}return!1},He=s.memo((function({title:e,tagline:t,items:n}){const{fetchMultipleColors:a}=(0,g.WQ)(),i=!(0,Pe.k)(),o=e??(()=>{const e=(new Date).getHours();let t=l.ag.get("home.evening");return e>=5&&e<12?t=l.ag.get("home.morning"):e>=12&&e<18&&(t=l.ag.get("home.afternoon")),t})(),[r,c]=Ae();return(0,s.useEffect)((()=>{const e=n?.map(g.lh)||[];a(e)}),[n,a]),i||!n?.length?null:(0,G.jsxs)("section",{className:w,"aria-label":o,ref:c,children:[(0,G.jsx)(be.r,{title:o,titleVariant:"alto",tagline:t}),(0,G.jsx)("div",{className:T,style:r.cssProperties,children:n.filter(((e,t)=>De(e)||!e.error)).filter(((e,t)=>t<6)).map(((e,t)=>{if(De(e))return(0,G.jsx)(ke,{index:t,item:e,showPlayButton:r.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`);const n=function(e){const t=((0,v.EC)(e)||{}).type;switch(t){case v.JM.ARTIST:return fe;case v.JM.ALBUM:case v.JM.COLLECTION_ALBUM:return pe;case v.JM.PLAYLIST:case v.JM.PLAYLIST_V2:return je;case v.JM.SHOW:return ye;case v.JM.EPISODE:return ve;case v.JM.COLLECTION:return je;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),ye}}(e.uri);return(0,G.jsx)(n,{index:t,item:e,showPlayButton:r.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`)}))})]})})),Je=e=>(0,G.jsx)(m.L,{onError:e=>{(0,h.vK)(e,"HomeShortcutsGrid")},children:(0,G.jsx)(He,{...e})});var $e=n(3105),Re=n(7359);const We="zUf7jtv9GPOKC1jYO5TO",ze="T8QLel3PoQTgJUpGYj7Q",Ge=(0,s.memo)((({isLoading:e})=>{const t=(0,$e.h)("shimmer");return(0,G.jsx)("div",{className:F,children:(0,G.jsx)("div",{ref:t,className:i()(M,{[ze]:e})})})})),qe=(0,s.memo)((({isLoading:e})=>(0,G.jsx)("div",{className:i()(B,We),"data-testid":"skeleton-shortcut",children:(0,G.jsxs)("div",{className:I,children:[(0,G.jsx)(Ge,{isLoading:e}),(0,G.jsx)("div",{className:U,children:(0,G.jsx)(Re.C,{as:"p",variant:"balladBold",className:H,isLoading:e})})]})}))),Ye="v7dc5ekmeBiAYnLzV8oT",Ze=(0,s.memo)((({shortcutCount:e})=>{const[t,n]=Ae();return(0,G.jsxs)("section",{className:w,ref:n,children:[(0,G.jsx)(Re.C,{as:"h2",variant:"alto",className:Ye,charCount:25,isLoading:!0}),(0,G.jsx)("div",{className:T,style:t.cssProperties,children:[...new Array(e).keys()].slice(0,6).map(((e,t)=>(0,G.jsx)(qe,{isLoading:!0},t)))})]})}));var Ke=n(58309),Ve=n(52054),Xe=n(3803),Qe=n(54955),et=n(882),tt=n(53699),nt=n(59804),st=n(72266),at=n(95240),it=n(42521),ot=n(63684),rt=n(35315),ct=n(95495),lt=n(73471),ut=n(65315);const mt=({spec:e,section:t,index:n})=>{const a=(0,r.W6)(lt.ty,{loadingValue:!1})?rt.N:ct.q;return(0,s.useMemo)((()=>t.sectionItems.items.some((e=>(0,ut.d)(e.content)))),[t.sectionItems])?(0,G.jsx)(ne.Nh,{spec:e.shelvesFactory(),children:(0,G.jsx)(a,{total:t.sectionItems.totalCount,seeAllUri:t.uri,pageId:t.uri,title:t.data.title?.text??"",index:n,id:t.uri,children:t.sectionItems.items.map(ut.x).filter((e=>!!e))})}):null};var dt=n(31816);const ht=({spec:e,section:t,index:n})=>(0,G.jsx)(ne.Nh,{spec:e.shelvesFactory(),children:(0,G.jsx)(dt.default,{title:t.data.title?.text??void 0,showAll:!1,index:n})});var xt=n(93704);const gt=({spec:e,greeting:t,section:n})=>(0,G.jsx)(ne.Nh,{spec:e.shortcutsFactory(),children:(0,G.jsx)(Je,{items:n.sectionItems.items.map(xt.lh),title:t??void 0})});var jt=n(1053);const pt=(0,s.lazy)((async()=>{const{FeatureActivationShelf:e}=await Promise.all([n.e(1814),n.e(8228)]).then(n.bind(n,29196));return{default:e}})),ft=({spec:e,greeting:t,section:n,index:a})=>{const i=(0,S._n)();switch(n.data?.__typename){case"HomeGenericSectionData":return(0,G.jsx)(mt,{spec:e,section:(0,jt.f)(n,n.data),index:a});case"HomeFeatureActivationSectionData":return(0,it.wW)()?(0,G.jsx)(s.Suspense,{fallback:null,children:(0,G.jsx)(pt,{})}):null;case"HomeShortsSectionData":return(0,G.jsx)(gt,{spec:e,greeting:t,section:(0,jt.f)(n,n.data)});case"HomeRecentlyPlayedSectionData":return(0,G.jsx)(ht,{spec:e,section:(0,jt.f)(n,n.data),index:a});case"HomeFeedBaselineSectionData":case"HomeNativeAdsSectionData":case"HomeOnboardingSectionData":case"HomeOnboardingSectionDataV2":return null;case"HomeYourDJSectionData":{if(!i)return null;const t=(0,jt.f)(n,n.data),{data:s,sectionItems:a}=t,o=a.items[0];if("PlaylistResponseWrapper"===o.content.__typename&&"Playlist"===o.content.data.__typename){const{data:t}=o.content;return(0,G.jsx)(S.KE,{spec:e,shelfTitle:s.title?.text??"",title:t.name,description:t.description??""})}return null}case null:case void 0:return null;default:return(0,ot._)(n.data),null}},yt=({spec:e,greeting:t,container:n})=>{const{spec:a,logger:i}=(0,ne.fU)(st.createDesktopHomeFeatureActivationShelfEventFactory,{});return(0,s.useEffect)((()=>{(0,at.wW)()&&i.logImpression(a.impressionElementFactory().impression())}),[a,i]),(0,G.jsx)(G.Fragment,{children:n.sections.items.map(((n,s)=>(0,G.jsx)(ft,{spec:e,greeting:t,section:n,index:s},`${s}-${n.uri}`)))})};var vt=n(67782),St=n(43639);const Ct=(0,s.memo)((({cardCount:e})=>(0,G.jsx)(St.X,{isLoading:!0,children:[...new Array(e).keys()].map(((e,t)=>(0,G.jsx)(vt.A,{isLoading:!0},t)))})));var Nt=n(9949),_t=n(73743);const kt=()=>(0,r.W6)(lt.Jw)===lt.pF.ONHOME?(0,G.jsx)(_t.w,{children:(0,G.jsx)(Nt.M,{onSearch:!1})}):null;var Pt=n(33600);const bt=6,Et=6,wt=6,Tt=(0,s.memo)((({shortcutCount:e,shelfCount:t,cardCount:n})=>(0,G.jsx)("section",{"data-testid":"home-page",children:(0,G.jsx)("div",{className:Pt.Z.home,children:(0,G.jsxs)("div",{className:i()(Pt.Z.content,"contentSpacing"),children:[(0,G.jsx)(Ze,{shortcutCount:e}),[...new Array(t).keys()].map(((e,t)=>(0,G.jsx)(Ct,{cardCount:n},t)))]})})}))),Lt=({spec:e})=>{(0,Ve.z)("home");const{data:t,error:n,loading:s}=(0,tt.b3)({timeZone:(0,nt.L7)()},{cacheTime:nt.us,staleTime:nt.fS});if(s)return(0,G.jsx)(Tt,{shortcutCount:bt,shelfCount:Et,cardCount:wt});if(null!==n)return(0,G.jsx)(Ke.h,{hasError:!0,errorMessage:l.ag.get("error.generic")});const a=t?.home;return"HomeResponsePayload"!==a?.__typename||0===a.sectionContainer.sections.totalCount||0===a.sectionContainer.sections.items.length?(0,G.jsx)(Ke.h,{hasError:!0,errorMessage:l.ag.get("error.generic")}):(0,G.jsx)("section",{"data-testid":"home-page",children:(0,G.jsx)("div",{className:Pt.Z.home,children:(0,G.jsx)("div",{className:i()(Pt.Z.content,"contentSpacing"),children:(0,G.jsx)(yt,{spec:e,greeting:a.greeting?.text??null,container:a.sectionContainer})})})})},Bt=()=>{const{spec:e}=(0,ne.fU)(c.createDesktopHomeEventFactory,{data:{identifier:"home",uri:"spotify:home"}}),t=(0,r.W6)(lt.yg),n=(0,o.v9)(V.br),a=(0,o.v9)(V.yE),i=(0,Qe.S)(t),m=(0,se.S9)({locale:l.ag.getLocale(),entity:"",localeFeatureFlag:n,entityFeatureFlag:a,type:"link"});return(0,G.jsx)(ne.Nh,{spec:e,children:(0,G.jsxs)(Xe.q,{config:i,children:[(0,G.jsx)(u.$,{children:(0,et.nW)({i18n:l.ag,shouldLocalize:m})}),(0,G.jsx)(s.Suspense,{fallback:null,children:(0,G.jsx)(kt,{})}),(0,G.jsx)(Lt,{spec:e})]})})}}}]);
//# sourceMappingURL=home-v2.js.map