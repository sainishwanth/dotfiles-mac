(()=>{var e,t={2253:(e,t,n)=>{"use strict";var a={};n.r(a),n.d(a,{ENTER_LOGIN_MODE:()=>_,ENTER_SETTINGS_MODE:()=>f,ENTER_SIGNUP_MODE:()=>g,ENTER_SIGNUP_MODE_STEP_0:()=>h,ENTER_SIGNUP_MODE_STEP_1:()=>E,ENTER_WELCOME_MODE:()=>S,INTERACTION:()=>b,START_APP:()=>m,enterLoginMode:()=>y,enterSettingsMode:()=>D,enterSignupMode:()=>A,enterSignupModeStep0:()=>T,enterSignupModeStep1:()=>N,enterWelcomeMode:()=>I,interaction:()=>O,openSignupPage:()=>C,startApp:()=>k});var i={};n.r(i),n.d(i,{ABORT_LOGIN_TYPE_ACCOUNTS:()=>ie,ACCOUNTS_METHODS:()=>oe,LOADING:()=>q,LOGIN_BEFORE:()=>$,LOGIN_CLEAR_ERRORS:()=>j,LOGIN_FAIL:()=>z,LOGIN_SUCCESS:()=>X,LOGIN_TYPE_ACCOUNTS:()=>ae,LOGIN_TYPE_AUTOLOGIN:()=>ne,LOGIN_TYPE_EMAIL:()=>Q,LOGIN_TYPE_FACEBOOK:()=>ee,LOGIN_TYPE_FACEBOOK_POPUP:()=>te,UTM_PARAMETERS:()=>Z,abortLoginWithAccounts:()=>me,fetchUTMParameters:()=>he,loading:()=>de,login:()=>ue,loginClearErrors:()=>_e,loginFailed:()=>le,loginSuccess:()=>se,loginWithAccounts:()=>pe,loginWithFacebookPopup:()=>ge,receivedUTMParameters:()=>Ee});var o={};n.r(o),n.d(o,{CLEAR_ALL_ERRORS:()=>Ge,COUNTRY_NOT_LAUNCHED:()=>Be,FACEBOOK_SIGNUP_ATTEMPT:()=>Pe,FACEBOOK_SIGNUP_FAILURE:()=>Fe,FACEBOOK_SIGNUP_SUCCESS:()=>we,SIGNUP_ATTEMPT:()=>Oe,SIGNUP_FAILURE:()=>ve,SIGNUP_RESTRICTIONS_FAILURE:()=>Ce,SIGNUP_RESTRICTIONS_SUCCESS:()=>De,SIGNUP_SUCCESS:()=>Le,UPDATE_SIGNUP_DATA:()=>xe,VALIDATE_FIELD_ATTEMPT:()=>Re,VALIDATE_FIELD_FAILURE:()=>Me,VALIDATE_FIELD_SUCCESS:()=>Ue,clearAllErrors:()=>it,countryNotLaunched:()=>at,facebookSignup:()=>ze,facebookSignupFailure:()=>Ze,facebookSignupSuccess:()=>qe,getSignupRestrictions:()=>We,signup:()=>Ye,signupAttempt:()=>Ke,signupFailure:()=>Xe,signupRestrictionsFailure:()=>He,signupRestrictionsSuccess:()=>Ve,signupSuccess:()=>$e,signupWithAccounts:()=>je,updateSignupData:()=>nt,validateField:()=>Je,validateFieldAttempt:()=>Qe,validateFieldFailure:()=>et,validateFieldSuccess:()=>tt});var r={};n.r(r),n.d(r,{SETTINGS_FETCH_PROXY_SETTINGS_FAILURE:()=>ft,SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS:()=>St,SETTINGS_RESTART_CLIENT_FAILURE:()=>Tt,SETTINGS_RESTART_CLIENT_SUCCESS:()=>At,SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE:()=>kt,SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS:()=>bt,fetchProxySettings:()=>Nt,restartClient:()=>It,updateProxySettings:()=>yt});var s=n(7294),l=n(3935),d=n(7209),c=n(6458),u=n(2976),p=n(685);const m="START_APP",g="ENTER_SIGNUP_MODE",h="ENTER_SIGNUP_MODE_STEP_0",E="ENTER_SIGNUP_MODE_STEP_1",_="ENTER_LOGIN_MODE",S="ENTER_WELCOME_MODE",f="ENTER_SETTINGS_MODE",b="INTERACTION";function k(){return{type:m}}function A(e=null){return{type:g,actionHash:e}}function T(){return{type:h}}function N(){return{type:E}}function y(e=null){return{type:_,actionHash:e}}function I(e=null){return{type:S,errorMessage:e}}function D(){return{type:f}}function C(e=!1){return(t,n)=>{const a=n();let i,o={};switch(e?"website":"desktop-app"){case"desktop-app":t(A());break;case"website":{o=a.login.utmParameters||{utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""};const e=Object.keys(o).reduce(((e,t)=>(e[t]=encodeURIComponent(o[t]),e)),{});i=`https://www.spotify.com/signup?utm_source=${e.utm_source}&utm_medium=${e.utm_medium}&utm_campaign=${e.utm_campaign}`,e.referral&&(i+=`&referral=${e.referral}&referrer=${e.referral}`),window.open(i);break}}}}function O(e,t,n,a,i){return{type:b,page:e,interactionType:t,intent:n,itemId:a,actionHash:i}}const v=e=>n.g&&"function"==typeof n.g._getSpotifyModule?new Promise(((t,a)=>{n.g._getSpotifyModule("bridge").executeRequest(JSON.stringify(e),{onSuccess:t,onFailure:a})})):null,L="https://www.spotify.com/redirect/account-page/",P="showSettings",w={id:"UnknownLoginErrorMessage"},F={id:"DefaultErrorMessage",replace:[P]},R={id:"FbFailureOpenPopup",silent:!0},M={127:{id:"SessionTerminatedMessage"},3:{id:"BadCredentialsMessage"},4:{id:"ErrorResolvingDNS"},53:{id:"ErrorProxyUnauthorized"},54:{id:"ErrorProxyForbidden"},55:{id:"ErrorProxyAuthRequired",replace:[P]},400:w,401:w,402:{id:"CriticalUpdate"},403:{id:"UserBannedMessage"},404:w,405:w,406:{id:"UserNotAllowedOnPlatformMessage"},407:{id:"MissingUserInfoMessage",replace:[L]},408:{id:"RegionMismatchMessage",replace:[L,"https://www.spotify.com/redirect/upgrade-product/"]},409:{id:"PremiumUsersOnlyMessage"},410:{id:"BadCredentialsMessage"},411:w,412:{id:"BadCredentialsMessage"},413:{id:"CreateUserDeniedMessage"},414:w,415:w,416:w,417:{id:"FacebookCredentialsMisusedMessage"},418:w,"critical-update-error":{id:"ClientUpdateFail",replace:["https://www.spotify.com/redirect/download/"]},1001:{silent:!0},1002:R,1003:{id:"FbUserNotFoundSignUp",replace:["showSignup"]},1004:R,1005:R,1006:R},U={1:w,2:w,3:{id:"BadCredentialsMessage"},4:w,5:w,6:w,7:w,8:w,9:w},x={1:{silent:!0},2:w,3:w,4:{id:"SessionExpiredMessage"},5:F},B=window.localStorage,G="lastUsername",W="THIS_USER_DOES_NOT_EXIST_AND_IS_A_PLACEHOLDER",V="utmParameters",H=B.getItem(V),Y=B.getItem(G),J={errorData:null,loginInProgress:!1,redirectTo:null,username:Y!==W?Y:"",utmParameters:H?JSON.parse(H):null};const K=function(e=J,t){switch(t.type){case Dt.LOADING:return{...e,loading:!0,throbberDelay:t.throbberDelay};case Dt.LOGIN_FAIL:return{...e,loading:!1,errorData:t.errorData,loggedIn:!1,loginInProgress:!1};case Dt.LOGIN_BEFORE:return{...e,errorData:t.errorData,loggedIn:!1,loginInProgress:t.loginInProgress,username:t.username};case Dt.LOGIN_SUCCESS:return{...e,loading:!1,loggedIn:!0,redirectDelay:t.redirectDelay||0,redirectTo:t.redirectTo,username:t.username};case Dt.UTM_PARAMETERS:return{...e,utmParameters:t.utmParameters};case Dt.LOGIN_CLEAR_ERRORS:return{...e,errorData:null};default:return e}},$="LOGIN_BEFORE",X="LOGIN_SUCCESS",j="LOGIN_CLEAR_ERRORS",z="LOGIN_FAIL",q="LOADING",Z="UTM_PARAMETERS",Q="login",ee="login-facebook",te="login-facebook-popup",ne="autologin",ae="login-accounts",ie="abort-login-accounts",oe={facebook:"facebook",apple:"apple",google:"google"};function re(e,t=Q){return{type:$,errorData:null,username:e||"",loginInProgress:t===Q,loginType:t}}function se(e,t,n=Q,a=!1,i){return{type:X,errorData:null,redirectTo:i,redirectDelay:t||0,username:e,loginType:n,afterSignup:a}}function le(e,t=Q){return{type:z,errorData:e,loginType:t}}function de(e){return{type:q,throbberDelay:e&&e.throbberDelay?e.throbberDelay:0}}const ce=async(e,t,{defaultErrorCode:n,redirectDelay:a=0}={},i=Q,o=!1,r=null,s=!0)=>{r&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=r);try{const n=JSON.parse(await v(t)).redirectTo||"xpui";let r=null;t&&t.args&&t.args[0]&&(r=t.args[0].username),e(se(s?r:W,a,i,o,n))}catch(t){let a=t;n?a={errorCode:n}:"string"==typeof t&&(a=JSON.parse(t)),a.errorCode&&M[a.errorCode]&&"FbFailureOpenPopup"===M[a.errorCode].id?e(ge(r)):e(le(a,i))}};function ue({username:e,password:t,rememberMe:n},a=!1,i=null){return o=>{const r=a?ne:Q;o(re(n?e:W,r));ce(o,{name:Q,args:[{username:e,password:t,rememberMe:n}]},{redirectDelay:200},r,a,i,n)}}function pe(e,t){return n=>{n(re(null,ae));ce(n,{name:ae,args:[{method:e,enableSignup:!1}]},{redirectDelay:200},ae,!1,t)}}function me(){return async()=>{await v({name:ie,args:[]})}}function ge(e=null){return t=>{t(re(null,ee));ce(t,{name:te,args:[]},{redirectDelay:200},ee,!1,e)}}function he(){return async e=>{e(Ee(JSON.parse(await v({name:"get-signup-utm-parameters",args:[]}))))}}function Ee(e){return{type:Z,utmParameters:e}}function _e(){return{type:j}}var Se=n(8495),fe=n.n(Se);function be(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.DESKTOP_SIGNUP_DEBUG_KEY;return e||"4c7a36d5260abca4af282779720cf631"}function ke(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.client_version||"";if(!e)throw new Error("Missing Spotify App Version! Something is wrong: talk to #desktop-squad.");return["Spotify-App-Version",e]}function Ae(){const e="undefined"!=typeof window&&window.navigator&&window.navigator.platform||"";let t="";if(-1!==e.indexOf("Mac")?t="OSX":-1!==e.indexOf("Win")?t="Win32":-1!==e.indexOf("Linux")&&(t="Linux"),!t)throw new Error("Missing App Platform! Something is wrong: talk to #desktop-squad.");return["App-Platform",t]}function Te(e){const t=new Map(Object.entries(e).sort()),n=function(e){const t=fe().create();return e.forEach((e=>{void 0!==e&&t.update(e.toString())})),t.hex()}(t);if(t.size>n.length)return t;const a=[...t],i=[...Array(t.size).keys()].sort((function(e,t){const i=n.charAt(e).localeCompare(n.charAt(t));return 0!==i?i:a[e][0].localeCompare(a[t][0])})),o=new Map;return i.forEach((function(e){o.set(a[e][0],a[e][1])})),o}const Ne=e=>async(t,n,a)=>{const i=function({name:e,email:t,password:n,gender:a,birthDate:i={},sendEmail:o,shareData:r,agreeEula:s}={},l={utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""},d=!1){const c=Object.keys(l).reduce(((e,t)=>(e[t]=encodeURIComponent(l[t]),e)),{});let u=`https://login.app.spotify.com?utm_source=${c.utm_source}&utm_medium=${c.utm_medium}&utm_campaign=${c.utm_campaign}`;c.referral&&(u+=`&referral=${c.referral}&referrer=${c.referral}`);const p={key:be(),displayname:e,email:t,password:n,password_repeat:n,gender:a,birth_year:i.year,birth_month:i.month,birth_day:i.day,iagree:s?1:0,creation_point:u,creation_flow:"desktop",platform:"desktop",referrer:c.referral};return"boolean"==typeof o&&(p["send-email"]=o),"boolean"==typeof r&&(p.thirdpartyemail=r),d&&Object.keys(p).forEach((e=>{void 0===p[e]&&delete p[e]})),Te(p)}(t,n,a),o=new FormData;i.forEach(((e,t)=>{o.append(t,e)}));const r=[ke(),Ae()].reduce(((e,t)=>(e[t[0]]=t[1],e)),{}),s={method:"POST",body:o,headers:{"App-Platform":r["App-Platform"],"Spotify-App-Version":r["Spotify-App-Version"],"X-Client-Id":{NODE_ENV:"production",DEBUG_EVENT_SENDER:!1,DEBUG_SEMANTIC_METRICS:void 0,PRODUCT_NAME:"desktop"}.SPOTIFY_CLIENT_ID}},l=new Request(e,s);((e,t)=>{const n=e.headers.get("content-type");e.headers.set("content-type",((e,t)=>[...e.split(";"),t].join(";"))(n,t))})(l,"charset=utf-8");const d=await fetch(l),{errors:c,...u}=await d.json()||{};if(c)throw c;return u},ye=Ne("https://spclient.wg.spotify.com/signup/public/v1/account/"),Ie=Ne("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=true");const De="SIGNUP_RESTRICTIONS_SUCCESS",Ce="SIGNUP_RESTRICTIONS_FAILURE",Oe="SIGNUP_ATTEMPT",ve="SIGNUP_FAILURE",Le="SIGNUP_SUCCESS",Pe="FACEBOOK_SIGNUP_ATTEMPT",we="FACEBOOK_SIGNUP_SUCCESS",Fe="FACEBOOK_SIGNUP_FAILURE",Re="VALIDATE_FIELD_ATTEMPT",Me="VALIDATE_FIELD_FAILURE",Ue="VALIDATE_FIELD_SUCCESS",xe="UPDATE_SIGNUP_DATA",Be="COUNTRY_NOT_LAUNCHED",Ge="CLEAR_ALL_ERRORS";function We(){return async(e,t)=>{const n=t();try{e(Ve(window.__spotify&&!0===window.__spotify.is_running_on_teamcity?{}:await(async()=>{const e=await fetch("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=1"),t=await e.json()||{};if(t.errors&&t.errors.length>0)throw t.errors;return t})()))}catch(t){e(He(t)),n.app&&n.app.mode&&"welcome"!==n.app.mode&&(e(y()),e(C(!0)))}}}function Ve(e){return{type:De,restrictions:e}}function He(e){return{type:Ce,error:e}}function Ye(e=null){return async(t,n)=>{t(Ke());const a=n().signup.formData,i=n().login.utmParameters;try{await ye(a,i),t($e());const{email:n,password:o}=a;t(ue({username:n,password:o,rememberMe:!0},!0,e))}catch(e){const n={};Object.keys(e).forEach((t=>{n["birthdate"===t?"birthDate":t]={message:e[t]}})),t(Xe(n))}}}function Je(e){return async(t,n)=>{const a=n().signup.formData[e],i=n().login.utmParameters;t(Qe(e,a));try{await Ie({[e]:a},i,!0)}catch(n){n[e]&&t(et(e,{message:n[e]}))}}}function Ke(){return{type:Oe}}function $e(){return{type:Le}}function Xe(e){return{type:ve,errors:e}}function je(e,t=null){return n=>{const a={name:ae,args:[{method:e,enableSignup:!0}]};n(ze()),(async(e,t,n=null)=>{n&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=n);try{const n=JSON.parse(await v(t)).redirectTo||"xpui";e(qe()),e(se(null,0,ne,!0,n))}catch(t){let n=t;"string"==typeof t&&(n=JSON.parse(t)),e(Ze(n))}})(n,a,t)}}function ze(){return{type:Pe}}function qe(){return{type:we}}function Ze(e){return{type:Fe,errorData:e}}function Qe(e,t){return{type:Re,field:e,value:t}}function et(e,t){return{type:Me,field:e,error:t}}function tt(e){return{type:Ue,field:e}}function nt(e){return{type:xe,data:e}}function at(){return{type:Be}}function it(){return{type:Ge}}let ot,rt,st;!function(e){e.af="af",e.am="am",e.ar="ar",e.az="az",e.bg="bz",e.bn="bn",e.bho="bho",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.es419="es-419",e.es="es",e.et="et",e.fa="fa",e.fi="fi",e.fil="fil",e.frCA="fr-CA",e.fr="fr",e.gu="gu",e.he="he",e.hi="hi",e.hr="hr",e.hu="hu",e.id="id",e.is="is",e.it="it",e.ja="ja",e.kn="kn",e.ko="ko",e.lt="lt",e.lv="lv",e.ml="ml",e.mr="mr",e.ms="ms",e.nb="bn",e.ne="ne",e.nl="nl",e.or="or",e.paIN="pa-IN",e.paPK="pa-PK",e.pl="pl",e.ptBR="pt-BR",e.ptPT="pa-PT",e.ro="ro",e.ru="ru",e.sk="sk",e.sl="sl",e.sr="sr",e.sv="sv",e.sw="sw",e.ta="ta",e.te="te",e.th="th_TH",e.tr="tr",e.uk="uk",e.ur="ur",e.vi="vi",e.zhCN="zh-CN",e.zhTW="zh-TW",e.zu="zu"}(ot||(ot={})),function(e){e.AR="، ",e.FA="، ",e.EN=", "}(rt||(rt={})),function(e){e.ZERO="zero",e.ONE="one",e.TWO="two",e.FEW="few",e.MANY="many",e.OTHER="other"}(st||(st={}));let lt={};function dt(e){return"number"==typeof e?e.toString():e.replace(/\$/,"$$$$")}const ct=e=>"ar"===e?"ar-u-nu-latn":e;const ut=new class{_relativeTimeFormat=new Intl.RelativeTimeFormat;_dateTimeFormats=new Map;constructor(){this._dictionary={},this._locale=ot.en}getDateTimeFormat(e){const t=JSON.stringify(Object.keys(e).sort().map((t=>({[t]:e[t]}))));let n=this._dateTimeFormats.get(t);return void 0===n&&(n=new Intl.DateTimeFormat(ct(this._locale),e),this._dateTimeFormats.set(t,n)),n}setDictionary(e){this._dictionary=e}setLocale(e){this._locale=e,this._dateTimeFormats.clear()}getLocale(){return this._locale}toLocaleLowerCase(e){return e?.toLocaleLowerCase(this._locale)}toLocaleUpperCase(e){return e?.toLocaleUpperCase(this._locale)}get(e,...t){const n=e in this._dictionary?this._dictionary[e]:e;let a="";if("string"!=typeof n){const e=t[0],i=((e,t)=>{try{return(lt[e]||(lt[e]=new Intl.PluralRules(e))).select(t)}catch{return st.OTHER}})(this._locale,parseInt(e,10)),o=n[i];void 0!==o?a=o:n.other&&(a=n.other)}else a=n;if(/%\d%/.test(a)){if(!["desktop.login.DefaultErrorMessage","desktop.login.ErrorProxyAuthRequired","desktop.login.MissingUserInfoMessage","desktop.login.RegionMismatchMessage","desktop.login.ClientUpdateFail","desktop.login.FbUserNotFoundSignUp","desktop.login.errorCode","desktop-auth.error"].includes(e))throw new Error("i18n: The placeholder format %0% is legacy and is only allowed for existing strings.")}if(t?.length>0)for(let e=0;e<t.length;e++){const n=t[e];if(null!=n)if("string"==typeof n)a=a.replace(`{${e}}`,dt(n)).replace(`%${e}%`,dt(n));else if("number"==typeof n){const t=this.formatNumber(n);a=a.replace(`{${e}}`,t).replace(`%${e}%`,t)}else if("object"==typeof n)for(const e of Object.keys(n)){const t=n[e];a=a.replace(`%${e}%`,dt(t))}}return a}getSeparator(){switch(this._locale){case ot.ar:return rt.AR;case ot.fa:return rt.FA;default:return rt.EN}}formatNumber(e,t){return e.toLocaleString(ct(this._locale),t)}formatNumberCompact(e){return this.formatNumber(e,{notation:"compact",maximumFractionDigits:1})}formatDate(e,t=null){const n=t||{year:"numeric",month:"long",day:"numeric"};return this.getDateTimeFormat(n).format(e)}formatRelativeDate(e,t=null){const n=new Date(Date.now()),a=(e=new Date(e)).getTime()-n.getTime();if(Math.abs(a)<2592e6){const{days:e,hours:t,minutes:n,seconds:o}=(i=a,{seconds:Math.round(i/1e3),minutes:Math.round(i/1e3/60),hours:Math.round(i/1e3/60/60),days:Math.round(i/1e3/60/60/24)});return e||t||n?e||t?e?this._relativeTimeFormat.format(e,"days"):this._relativeTimeFormat.format(t,"hours"):this._relativeTimeFormat.format(n,"minutes"):this._relativeTimeFormat.format(o,"seconds")}var i;return this.formatDate(e,t)}__resetForTests(){this._dictionary={},this._locale=ot.en,lt={}}},pt=2,mt=3,gt=4,ht={"auto-detect":{label:()=>ut.get("desktop.settings.proxy.autodetect")},"no-proxy":{label:()=>ut.get("desktop.settings.proxy.noproxy")},http:{label:()=>ut.get("desktop.settings.proxy.http")},socks4:{label:()=>ut.get("desktop.settings.proxy.socks4")},socks5:{label:()=>ut.get("desktop.settings.proxy.socks5")}},Et=[{enumKey:"auto-detect",enumValue:0},{enumKey:"no-proxy",enumValue:1},{enumKey:"http",enumValue:2},{enumKey:"socks4",enumValue:3},{enumKey:"socks5",enumValue:4}],_t="sp://proxy/v1/";const St="SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS",ft="SETTINGS_FETCH_PROXY_SETTINGS_FAILURE",bt="SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS",kt="SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE",At="SETTINGS_RESTART_CLIENT_SUCCESS",Tt="SETTINGS_RESTART_CLIENT_FAILURE";function Nt(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"GET",uri:_t}),persistent:!1,onSuccess:n=>{const a=JSON.parse(n);200!==a.status&&t(new Error(`Failed to fetch proxy settings (status code: ${a.status})`));const i=JSON.parse(a.body);e({mode:i["network.proxy.mode"],address:i["network.proxy.addr"],username:i["network.proxy.user"],password:i["network.proxy.pass"]})},onFailure:(e,n)=>{t(e)}})}))})().then((t=>{e(function(e){return{type:St,data:e}}(t))}),(t=>{e(function(e){return{type:ft,error:e}}(t))}))}}function yt(e){return t=>{(async function(e){return new Promise(((t,n)=>{const a={"network.proxy.mode":e.mode};[pt,mt,gt].includes(e.mode)&&(a["network.proxy.addr"]=e.address,a["network.proxy.user"]=e.username),[pt,gt].includes(e.mode)&&(a["network.proxy.pass"]=e.password),window.sendCosmosRequest({request:JSON.stringify({method:"PUT",uri:_t,body:JSON.stringify(a)}),persistent:!1,onSuccess:()=>{t()},onFailure:(e,t)=>{n(e)}})}))})(e).then((()=>{t({type:bt}),t(Nt())}),(e=>{t(function(e){return{type:kt,error:e}}(e))}))}}function It(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"POST",uri:"sp://desktop/v1/restart"}),persistent:!1,onSuccess:()=>{e()},onFailure:(e,n)=>{t(e)}})}))})().then((()=>{e({type:At})}),(t=>{e(function(e){return{type:Tt,error:e}}(t))}))}}const Dt={...a,...i,...o,...r};class Ct extends s.Component{constructor(e){super(e),this.state={hidden:this.props.delay>0}}componentDidMount(){!0===this.state.hidden&&(this.throbberTimeout=setTimeout((()=>{this.setState({hidden:!1})}),this.props.delay))}componentWillUnmount(){this.throbberTimeout&&clearTimeout(this.throbberTimeout)}render(){return this.state.hidden?null:s.createElement("div",{"data-testid":"glue-throbber",className:"GlueThrobber "+(this.props.initial?"throbber-initial":"throbber")},s.createElement("div",null))}}Ct.defaultProps={delay:0,initial:!0};var Ot=n(2808),vt=n.n(Ot);function Lt(){return vt().create().toString()}var Pt=n(6668),wt=n(9450);class Ft extends s.PureComponent{constructor(e){super(e),this.handleLoginClick=this.handleLoginClick.bind(this),this.handleErrorClick=this.handleErrorClick.bind(this)}handleLoginClick(){const e=Lt();this.props.openLoginPage(e),this.props.onInteraction("login/welcome","click","open-page-login",null,e)}handleErrorClick(e){if(e.target.getAttribute("data-action")){"showSettings"===e.target.getAttribute("data-action")&&this.props.openSettingsPage()}}render(){const{errorMessage:e}=this.props;return s.createElement("main",{className:"Welcome","data-testid":"welcome"},s.createElement("h1",{className:"HeroText __welcome"},ut.get("desktop-auth.login.millions-of-songs"),s.createElement("br",null),ut.get("desktop-auth.login.free-on-spotify")),s.createElement("div",{className:"Welcome__signup-or-login"},e&&s.createElement("div",{className:"Welcome__error-message",role:"alert",onClick:this.handleErrorClick,"aria-live":"assertive"},s.createElement(Pt.l,{className:"Welcome__error-message__icon"}),s.createElement("span",{dangerouslySetInnerHTML:{__html:e}})),s.createElement(wt.D,{id:"login-button",onClick:this.handleLoginClick,"data-ta-id":"welcome-login-button","data-testid":"login-button",fullWidth:!0},ut.get("desktop.login.LoginButton"))))}}const Rt=(0,c.$j)((e=>({errorMessage:e.app.errorMessage})),(e=>({openLoginPage:t=>e(Dt.enterLoginMode(t)),openSettingsPage:()=>e(Dt.enterSettingsMode()),onInteraction:(t,n,a,i,o)=>e(Dt.interaction(t,n,a,i,o))})))(Ft);var Mt=n(7873),Ut=n(4657),xt=n(1770),Bt=n(4184),Gt=n.n(Bt);function Wt(e,t,n){if(0===t)return!1;if(!e&&!t)return!1;let a=M;switch(e){case"session":a=U;break;case"desktop_login_accounts":a=x}const i=a[t]||F;if(i.silent)return!1;const o=i.replace||[];let r="";switch(i.id){case"UnknownLoginErrorMessage":r=ut.get("desktop.login.UnknownLoginErrorMessage");break;case"DefaultErrorMessage":r=ut.get("desktop.login.DefaultErrorMessage",o[0]);break;case"SessionTerminatedMessage":r=ut.get("desktop.login.SessionTerminatedMessage");break;case"SessionExpiredMessage":r=ut.get("desktop.login.SessionExpiredMessage");break;case"BadCredentialsMessage":r=ut.get("desktop.login.BadCredentialsMessage");break;case"ErrorResolvingDNS":r=ut.get("desktop.login.ErrorResolvingDNS");break;case"ErrorProxyUnauthorized":r=ut.get("desktop.login.ErrorProxyUnauthorized");break;case"ErrorProxyForbidden":r=ut.get("desktop.login.ErrorProxyForbidden");break;case"ErrorProxyAuthRequired":r=ut.get("desktop.login.ErrorProxyAuthRequired",o[0]);break;case"CriticalUpdate":r=ut.get("desktop.login.CriticalUpdate");break;case"UserBannedMessage":r=ut.get("desktop.login.UserBannedMessage");break;case"UserNotAllowedOnPlatformMessage":r=ut.get("desktop.login.UserNotAllowedOnPlatformMessage");break;case"MissingUserInfoMessage":r=ut.get("desktop.login.MissingUserInfoMessage",o[0]);break;case"RegionMismatchMessage":r=ut.get("desktop.login.RegionMismatchMessage",o[0],o[1]);break;case"PremiumUsersOnlyMessage":r=ut.get("desktop.login.PremiumUsersOnlyMessage");break;case"CreateUserDeniedMessage":r=ut.get("desktop.login.CreateUserDeniedMessage");break;case"ClientUpdateFail":r=ut.get("desktop.login.ClientUpdateFail",o[0]);break;case"FbUserNotFoundSignUp":r=ut.get("desktop.login.FbUserNotFoundSignUp",o[0])}return`${r}<br>${ut.get("desktop.login.errorCode",n)}`}function Vt({validity:e={}}){return e.valid?null:["valueMissing","typeMismatch","tooShort"].find((t=>e[t]))}const Ht=()=>s.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8ZM7.25 3V10H8.75V3H7.25ZM7.25 11.5256V13.0256H8.75V11.5256H7.25Z",fill:"#eb6471"}));class Yt extends s.PureComponent{render(){const{errorMessage:e}=this.props;return s.createElement("div",{"aria-live":"polite",className:Gt()("FieldError",{"FieldError--hidden":!e})},s.createElement(Ht,null),s.createElement("span",null,e||""))}}let Jt=0;class Kt extends s.PureComponent{constructor(...e){super(...e),this.idNumber=++Jt,this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onChange(e)}render(){const{label:e,placeholderLabel:t,name:n,type:a,isRequired:i,taId:o,id:r,defaultValue:l,value:d,minLength:c,autoFocus:u,hasError:p,isDisabled:m,isHiddenForScreenReaders:g,useCustomStyle:h,className:E,inputClassName:_,inputRef:S,onBlur:f,onFocus:b,onInput:k,onKeyDown:A,onKeyUp:T}=this.props,N=r||`GlueTextInput-${this.idNumber}`;return s.createElement("label",{className:h?E:"GlueTextInput",htmlFor:N,"aria-label":e,"aria-hidden":!!g||void 0},s.createElement("input",{className:h?_:Gt()("GlueTextInput__input",{"GlueTextInput__input--has-error":p}),tabIndex:g?"-1":void 0,type:a,id:N,name:n,"data-ta-id":o,"aria-invalid":p,disabled:m,minLength:c,autoFocus:u,placeholder:t||e,value:l?void 0:d,defaultValue:l,onBlur:f,onFocus:b,onChange:this.handleChange,onInput:l?void 0:k,onKeyDown:A,onKeyUp:T,ref:S,required:i}))}}Kt.defaultProps={name:"",type:"text",isRequired:!1,taId:"",defaultValue:void 0,value:"",minLength:0,autoFocus:!1,hasError:!1,isDisabled:!1,isHiddenForScreenReaders:!1,useCustomStyle:!1,onBlur(){},onFocus(){},onChange(){},onInput(){},onKeyDown(){}};class $t extends s.PureComponent{constructor(e){super(e),this.state={isEditing:!1,passwordVisible:!1},this.handleBlur=this.handleBlur.bind(this),this.handleInput=this.handleInput.bind(this)}handleBlur({target:e,relatedTarget:t}){this.setState({isEditing:!1}),t&&(t.name||"submit"===t.type)&&this.validate(e)}handleInput(){this.setState({isEditing:!0})}handleTogglePasswordVisible=()=>{const e=!this.state.passwordVisible;this.setState({passwordVisible:e}),this.props.onTogglePasswordVisibility&&this.props.onTogglePasswordVisibility(e)};validate(e){const{name:t,onValidate:n,noValidate:a}=this.props;!a&&n&&n(t,Vt(e))}renderPasswordEyeToggler(){const{type:e}=this.props,{passwordVisible:t}=this.state;return"password"!==e?null:s.createElement(s.Fragment,null,s.createElement("button",{type:"button",onClick:this.handleTogglePasswordVisible,tabIndex:"-1",className:"FormField--passwordEyeIcon "+(t?"passwordVisible":"")}),s.createElement("span",{tabIndex:"-1",className:"FormField--passwordEyeIcon--cross "+(t?"passwordVisible":"")}))}render(){const{error:e={},noValidate:t,label:n,name:a,type:i,value:o,isRequired:r,minLength:l,autoFocus:d,isDisabled:c,onChange:u,onKeyUp:p,onFocus:m,rightIcon:g=null}=this.props,{isEditing:h,passwordVisible:E}=this.state,_=g;let S=i;return"password"===i&&E&&(S="text"),s.createElement("div",{className:Gt()("FormField",{"FormField--no-validate":t})},s.createElement(Kt,{label:n,name:a,type:S,taId:`${a}-field`,value:o,isRequired:r,minLength:l,autoFocus:d,hasError:!!e.message&&!h,isDisabled:c,onChange:u,onFocus:m,onKeyUp:p,onBlur:this.handleBlur,onInput:this.handleInput}),_&&s.createElement(_,{className:"FormField--rightIcon"}),this.renderPasswordEyeToggler(),!t&&!h&&e.message&&s.createElement(s.Fragment,null,s.createElement(Yt,{errorMessage:e.message})))}}const Xt=(0,c.$j)((()=>({})),(()=>({})))($t);var jt=n(7154),zt=n.n(jt);class qt extends s.PureComponent{constructor(...e){super(...e),this.handleBlur=this.handleBlur.bind(this)}handleBlur(e={}){this.props.onBlur&&this.props.onBlur(e)}render(){const{type:e="text",name:t,label:n,classes:a,hasError:i,...o}=this.props,r=`${t}-field`;return s.createElement("span",{className:a},s.createElement("label",{className:"glue-hidden-visually",htmlFor:r},n),s.createElement("input",zt()({},o,{onBlur:this.handleBlur,type:e,name:t,id:r,"data-ta-id":r,className:Gt()("form-control Input",{"Input--has-error":i}),"aria-invalid":!!i,placeholder:n,required:!0})))}}const Zt=(new Date).getFullYear()-120,Qt=(e,t,n)=>{let a=null;return((e,t,n)=>[e,t,n].reduce(((e,t)=>e&&!!t),!0))(e,t,n)?((e,t,n)=>{const a=new Date(n,t-1,e);return!(a.getFullYear()<Zt)&&a.getDate()===e&&a.getMonth()===t-1&&a.getFullYear()===n})(e,t,n)||(a="invalid"):a="incomplete",a},en={BIG_ENDIAN:"big",LITTLE_ENDIAN:"little",MIDDLE_ENDIAN:"middle"};class tn extends s.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.monthStrings=[ut.get("desktop.login.January"),ut.get("desktop.login.February"),ut.get("desktop.login.March"),ut.get("desktop.login.April"),ut.get("desktop.login.May"),ut.get("desktop.login.June"),ut.get("desktop.login.July"),ut.get("desktop.login.August"),ut.get("desktop.login.September"),ut.get("desktop.login.October"),ut.get("desktop.login.November"),ut.get("desktop.login.December")],this.handleInput=this.handleInput.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleInput({target:{name:e,value:t,validity:n={}}}){this.setState({isEditing:!0}),n.valueMissing?this.props.onChange({...this.props.value,[e]:void 0}):(n.valid||n.rangeUnderflow)&&this.props.onChange({...this.props.value,[e]:parseInt(t,10)})}handleBlur(e){const t=e.relatedTarget?e.relatedTarget.name:null,n=["day","month","year"].includes(t);this.setState({isEditing:n}),n||this.validate()}handleFocus(e){this.setState({isEditing:!0});const t=e.relatedTarget?e.relatedTarget.name:null;!["day","month","year"].includes(t)&&this.props.onFocus&&this.props.onFocus()}validate(){const{day:e,month:t,year:n}=this.props.value,a=Qt(e,t,n,this.props.minAge);this.props.onValidate("birthDate",a)}renderYear(e,t,n){return s.createElement(qt,{type:"number",name:"year",classes:"FormDate__input FormDate__year",label:ut.get("desktop.login.Year"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:Zt,hasError:t.includes("year"),onFocus:this.handleFocus})}renderMonth(e,t,n){return s.createElement("select",{name:"month",id:"month-field",className:Gt()("form-control Input FormDate__input FormDate__month",{"Input--has-error":t.includes("month")}),autoFocus:n,defaultValue:e||"",required:!0,onChange:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,onFocus:this.handleFocus},s.createElement("option",{value:"",disabled:!0,hidden:!0},ut.get("desktop.login.Month")),this.monthStrings.map(((e,t)=>s.createElement("option",{value:t+1,key:t},e))))}renderDay(e,t,n){return s.createElement(qt,{type:"number",name:"day",classes:"FormDate__input FormDate__day",label:ut.get("desktop.login.Day"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:1,max:31,hasError:t.includes("day"),onFocus:this.handleFocus})}render(){const{name:e,label:t,dateEndianness:n,error:a={},autoFocus:i}=this.props,{day:o,month:r,year:l}=this.props.value,{isEditing:d}=this.state,c=["day","month","year"].filter((e=>!(d||!a.message)&&("incomplete"===a.code?!this.props.value[e]:"tooOld"!==a.code||"year"===e)));let u="";return u="big"===en[n]?s.createElement("div",{className:"FormDate__inputs"},this.renderYear(l,c,i),this.renderMonth(r,c),this.renderDay(o,c)):"little"===en[n]?s.createElement("div",{className:"FormDate__inputs"},this.renderDay(o,c,i),this.renderMonth(r,c),this.renderYear(l,c)):s.createElement("div",{className:"FormDate__inputs"},this.renderMonth(r,c,i),this.renderDay(o,c),this.renderYear(l,c)),s.createElement("div",{className:"FormDate"},s.createElement("label",{className:`FormDate__label ${e}-label`,htmlFor:"month-field"},t),u,!d&&a.message&&s.createElement(s.Fragment,null,s.createElement(Yt,{errorMessage:a.message})))}}tn.defaultProps={value:{},dateEndianness:"MIDDLE_ENDIAN",minAge:13};const nn=(0,c.$j)((()=>({})),(()=>({})))(tn);class an extends s.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleBlur(e){this.state={isEditing:!1};(e.relatedTarget?e.relatedTarget.name:null)!==this.props.name&&this.validate(e.target)}handleFocus(e){this.state={isEditing:!0},this.props.onOptionFocus&&e&&e.target&&this.props.onOptionFocus(e.target.value)}validate(e){const{name:t,onValidate:n}=this.props;n&&n(t,Vt(e))}render(){const{name:e,label:t,options:n,value:a,showTitle:i,error:o={},onValidate:r,onOptionFocus:l,...d}=this.props,{isEditing:c}=this.state,u=`${e}-field`,p=Gt()("FormRadioSelect",{"FormRadioSelect--is-disabled":this.props.disabled});return s.createElement("div",{className:p},s.createElement("label",{className:i?"":"glue-hidden-visually",htmlFor:u},t),n.map((t=>{const n=`${t.value}-radio`;return s.createElement("span",{className:a===t.value?"checked":"",key:t.value},s.createElement("input",zt()({},d,{name:e,type:"radio",id:n,className:"glue-hidden-visually",value:t.value,checked:a===t.value,onBlur:this.handleBlur,onFocus:this.handleFocus,required:!0,disabled:this.props.disabled})),s.createElement("label",{className:Gt()("FormRadioSelect__label",{"FormRadioSelect__label--has-error":!!o.message}),htmlFor:n},t.label))})),!c&&o.message&&s.createElement(s.Fragment,null,s.createElement(Yt,{errorMessage:o.message})))}}const on=(0,c.$j)((()=>({})),(()=>({})))(an);class rn extends s.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.isDisabled||this.props.onChange(e.target.checked)}render(){const e=`${this.props.name}-field`,t=Gt()("GlueCheckbox",{"GlueCheckbox--is-disabled":this.props.isDisabled});return s.createElement("div",{className:t},s.createElement("input",{className:"GlueCheckbox__input",id:e,name:this.props.name,checked:this.props.isChecked,type:"checkbox",onChange:this.handleChange,disabled:this.props.isDisabled}),s.createElement("label",{className:"GlueCheckbox__label",htmlFor:e,dangerouslySetInnerHTML:{__html:this.props.label}}))}}rn.defaultProps={label:"",name:"",isChecked:!1,isDisabled:!1,onChange(){}};class sn extends s.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(e){if(e.target.getAttribute("data-action")){const t=e.target.getAttribute("data-action");"showSettings"===t?this.props.openSettingsPage():"showSignup"===t&&this.props.openSignupPage()}}render(){const e=this.props.errorData,t=e?Wt(e.errorCategory,e.errorCode,e.errorReference):null;return t?s.createElement("div",{className:"alert alert-danger ErrorMessage alert-icon",id:"login-message","data-ta-id":"login-message","data-testid":"login-message",role:"alert","aria-live":"assertive",onClick:this.handleClick},s.createElement(Pt.l,{iconSize:24}),s.createElement("span",{dangerouslySetInnerHTML:{__html:t}})):null}}const ln=(0,c.$j)((e=>{let{mode:t}=e.app;return"welcome"===t&&(t="signup"),{errorData:e[t]&&e[t].errorData?e[t].errorData:null}}),(e=>({openSettingsPage:()=>e(Dt.enterSettingsMode()),openSignupPage:()=>e(Dt.openSignupPage())})))(sn);class dn extends s.PureComponent{static getNextId(){const e=(dn.instanceCount||0)+1;return dn.instanceCount=e,e}constructor(e){super(e),this.state={tosAgreed:!1,privacyAgreed:!1},this.handleTosChange=this.handleTosChange.bind(this),this.handlePrivacyChange=this.handlePrivacyChange.bind(this),this.handleTosAndPrivacyChange=this.handleTosAndPrivacyChange.bind(this),this.handleEulaChange=this.handleEulaChange.bind(this),this.eulaId=dn.getNextId()}handleTosChange(e){this.setState({tosAgreed:e},(()=>{this.handleEulaChange()}))}handlePrivacyChange(e){this.setState({privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleTosAndPrivacyChange(e){this.setState({tosAgreed:e,privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleEulaChange(){this.props.onChange(this.state.tosAgreed&&this.state.privacyAgreed)}render(){let e=null;const t=`<a href="https://www.spotify.com/int/legal/end-user-agreement/" target="_new">${ut.get("desktop.login.TermsAndConditions")}</a>`,n=`<a href="https://www.spotify.com/int/legal/privacy-policy/" target="_new">${ut.get("desktop.login.PrivacyPolicy")}</a>`,a=ut.get("desktop.login.SignupButton");return e=this.props.restrictions.pretick_eula?s.createElement("div",null,!this.props.hideTermsAndConditions&&s.createElement("p",{className:"SignupForm__terms-and-conditions",dangerouslySetInnerHTML:{__html:ut.get("desktop.login.SignupAgree",a,t)}}),!this.props.hidePrivacyPolicy&&s.createElement("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:ut.get("desktop.login.PrivacyPolicyAgree",n)}})):this.props.restrictions.can_accept_licenses_in_one_step?s.createElement("div",{className:"SignupForm__checkbox-container"},s.createElement(rn,{"data-ta-id":"agree-eula",name:`agree-eula-${this.eulaId}`,label:this.props.restrictions.specific_licenses?ut.get("desktop.login.SignupAgreeCheckboxSpecificLicenses",t,n):ut.get("desktop.login.SignupAgreeCheckbox",t,n),onChange:this.handleTosAndPrivacyChange,isChecked:this.state.tosAgreed&&this.state.privacyAgreed,isDisabled:this.props.disabled}),this.props.restrictions.specific_licenses&&s.createElement("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:ut.get("desktop.login.PrivacyPolicyAgree",n)}})):s.createElement("div",null,s.createElement("div",{className:"SignupForm__checkbox-container"},s.createElement(rn,{"data-ta-id":"agree-tos",name:`agree-tos-${this.eulaId}`,label:ut.get("desktop.login.TermsOfServiceAgreeCheckbox",t),onChange:this.handleTosChange,isChecked:this.state.tosAgreed,isDisabled:this.props.disabled})),s.createElement("div",{className:"SignupForm__checkbox-container"},s.createElement(rn,{"data-ta-id":"agree-privacy",name:`agree-privacy-${this.eulaId}`,label:ut.get("desktop.login.PrivacyPolicyAgreeCheckbox",n),onChange:this.handlePrivacyChange,isChecked:this.state.privacyAgreed,isDisabled:this.props.disabled}))),s.createElement("div",{className:"EulaAgreement"},e,this.props.error&&s.createElement(s.Fragment,null,s.createElement(Yt,{errorMessage:this.props.error.message})))}}const cn=(0,c.$j)((()=>({})),(()=>({})))(dn);class un extends s.PureComponent{handleClick=e=>{const{method:t}=this.props;e&&(e.preventDefault(),e.stopPropagation()),this.props.onClick(t)};render(){const{type:e,label:t,isDisabled:n,method:a}=this.props,i=a.substr(0,1).toUpperCase()+a.substr(1),o=Gt()("button","SocialButton",`${i}Button`,{[`${i}Button--login`]:"login"===e,[`${i}Button--signup`]:"signup"===e});return s.createElement("button",{type:"button",className:o,onClick:this.handleClick,"data-ta-id":`${a}-${e}-button`,disabled:n},t)}}class pn extends s.PureComponent{static defaultProps={isDisabled:!1,hideEula:!1};constructor(e){super(e),this.state={eulaAgreed:this.props.restrictions.pretick_eula,error:{}}}handleAgreeEulaChange=e=>{const t=e?"checked":"unchecked";this.props.onInteraction("signup","click",`eula-change-${t}`),this.setState({eulaAgreed:e,error:e?{}:this.state.error})};handleOnClick=(...e)=>{(()=>this.state.eulaAgreed||this.props.restrictions.pretick_eula||this.props.hideEula)()?this.props.onClick(...e):this.setState({error:{message:ut.get("desktop.login.agreeEula.notAccepted")}})};render(){return s.createElement("div",{className:"SignupFacebook"},s.createElement(un,{method:"facebook",isDisabled:this.props.isDisabled,onClick:this.handleOnClick,type:"signup",label:ut.get("desktop.login.SignupButtonFacebookNirvana")}),this.props.restrictions.pretick_eula||this.props.hideEula?null:s.createElement(cn,{restrictions:this.props.restrictions,error:this.state.error,disabled:this.props.isDisabled,onChange:this.handleAgreeEulaChange}))}}const mn=(0,c.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})),(e=>({onInteraction:(t,n,a,i,o)=>e(Dt.interaction(t,n,a,i,o)),onClick:t=>{const n=Lt();e(Dt.signupWithAccounts(t,n)),e(Dt.interaction("signup","click",`create-account-${t}`,null,n))}})),((e,t)=>({...e,...t,onClick:e=>{t.onClick(e)}})))(pn),gn=({title:e})=>s.createElement("p",{className:"FormTitleSeparator","aria-hidden":"true"},e);gn.defaultProps={title:""};const hn=gn;class En extends s.PureComponent{static defaultProps={errors:{},data:{},step:0};constructor(e){super(e),this.state={isEditing:!0}}handleEmailValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validateEmail()};handleEmailFocus=()=>{this.props.onInteraction("signup","click","input-email")};handlePasswordValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validatePassword()};handlePasswordFocus=()=>{this.props.onInteraction("signup","click","input-password")};handleNameFocus=()=>{this.props.onInteraction("signup","click","input-name")};handleGenderOptionFocus=e=>{this.props.onInteraction("signup","click",`input-gender-${e}`)};handleInputChange=({target:{name:e,value:t}})=>{this.props.updateData({[e]:t}),this.setState({isEditing:!0})};handleBirthDateChange=e=>{this.props.updateData({birthDate:e})};handleSendEmailChange=e=>{this.props.updateData({sendEmail:e})};handleShareDataChange=e=>{this.props.updateData({shareData:e})};handleAgreeEulaChange=e=>{this.props.updateData({agreeEula:e})};handleSubmit=e=>{e&&e.preventDefault();const{step:t}=this.props,n=Lt();this.props.onInteraction("signup","click",0===t?"continue":"create-account",null,n),this.setState({isEditing:!1});let a=!0;const i={0:["email","password","name"],1:["birthDate","gender","agreeEula"]};!!this.props.errors&&Object.keys(this.props.errors).filter((e=>-1!==i[t].indexOf(e))).some((e=>this.props.errors[e]&&this.props.errors[e].message))&&(a=!1);const o=e=>t=>{this.props.data[t]||(this.props.onValidate(t,{code:e}),a=!1)};switch(t){case 0:["email","password","name"].forEach(o("valueMissing"));break;case 1:{const{day:e,month:t,year:i}=this.props.data.birthDate;i||this.props.onInteraction("signup","view","show-error-empty-year",null,n),t||this.props.onInteraction("signup","view","show-error-empty-month",null,n),e||this.props.onInteraction("signup","view","show-error-empty-date",null,n);const r=Qt(e,t,i,this.props.restrictions.minimum_age);r&&(this.props.onValidate("birthDate",{code:r}),a=!1),o("valueMissing")("gender"),o("notAccepted")("agreeEula")}}if(a)switch(t){case 0:this.setStep(t+1);break;case 1:this.props.signup(n)}};handleBack=()=>{const{step:e}=this.props;this.props.onInteraction("signup","click",`back-step-${e+1}`),this.props.clearAllErrors(),e<=0?this.props.enterWelcomeMode():this.setStep(e-1)};handleLogin=()=>{const e=Lt();this.props.onInteraction("signup","click","open-page-login",null,e),this.props.enterLoginMode(e)};setStep=e=>{switch(e){case 0:this.props.enterSignupModeStep0();break;case 1:this.props.enterSignupModeStep1()}};renderErrorMsg(){const e=Object.keys(this.props.errors).filter((e=>this.props.errors[e]&&this.props.errors[e].message));return s.createElement("div",{className:"glue-hidden-visually",role:"alert","aria-live":this.state.isEditing?"off":"assertive"},e.length>0?s.createElement("div",null,s.createElement("p",null,ut.get("desktop.login.email.errorMessageA11y",e.length)),s.createElement("ul",null,e.map((e=>s.createElement("li",{key:e},this.props.errors[e].message))))):null)}renderStep0(){const{data:e,errors:t,isDisabled:n,onValidate:a}=this.props;return s.createElement("div",null,s.createElement(Xt,{name:"email",type:"email",label:ut.get("desktop.login.SignupEmail"),value:e.email,onChange:this.handleInputChange,isDisabled:n,error:t.email,onValidate:this.handleEmailValidate,onFocus:this.handleEmailFocus,isRequired:!0,autoFocus:!0,rightIcon:Mt.B}),s.createElement(Xt,{name:"password",type:"password",label:ut.get("desktop.login.CreateAPassword"),value:e.password,onChange:this.handleInputChange,minLength:8,isRequired:!0,isDisabled:n,error:t.password,onValidate:this.handlePasswordValidate,onFocus:this.handlePasswordFocus,onTogglePasswordVisibility:e=>{this.props.onInteraction("signup","click",e?"toggle-password-visibility-show":"toggle-password-visibility-hide")}}),s.createElement(Xt,{name:"name",label:ut.get("desktop.login.SignupName"),value:e.name,onChange:this.handleInputChange,isRequired:!0,isDisabled:n,error:t.name,onValidate:a,rightIcon:Ut.W,onFocus:this.handleNameFocus}))}renderStep1(){const{data:e,errors:t,restrictions:n,isDisabled:a,onValidate:i}=this.props;let o=null;n.requires_marketing_opt_in_text?o=s.createElement("div",{className:"SignupForm__send-email-implicit"},ut.get("desktop.login.SendEmailImplicitLabel")):n.requires_marketing_opt_in&&(o=s.createElement("div",{className:"SignupForm__checkbox-container"},s.createElement(rn,{name:"send-email",label:ut.get("desktop.login.SendEmailLabel"),onChange:this.handleSendEmailChange,isChecked:e.sendEmail,isDisabled:a})));const r=[{label:ut.get("desktop.login.Female"),value:"female"},{label:ut.get("desktop.login.Male"),value:"male"}];return n.use_all_genders&&r.push({label:ut.get("desktop.login.NonBinary"),value:"neutral"}),s.createElement("div",null,s.createElement(nn,{name:"birth-date",label:ut.get("desktop.login.WhatsYourSignupBirthDate"),value:e.birthDate,onChange:this.handleBirthDateChange,disabled:a,error:t.birthDate,onValidate:i,dateEndianness:n.date_endianness,minAge:n.minimum_age,autoFocus:!0,onFocus:()=>{this.props.onInteraction("signup","click","input-birth-date")}}),s.createElement(on,{showTitle:!0,name:"gender",label:ut.get("desktop.login.WhatsYourSignupGender"),options:r,value:e.gender,onChange:this.handleInputChange,disabled:a,error:t.gender,onValidate:i,onOptionFocus:this.handleGenderOptionFocus}),o,s.createElement(cn,{restrictions:n,error:t.agreeEula,disabled:a,onChange:this.handleAgreeEulaChange}))}render(){const{isDisabled:e,step:t}=this.props;return s.createElement("form",{onSubmit:this.handleSubmit,className:"SignupForm"},this.renderErrorMsg(),s.createElement(ln,null),0===t?this.renderStep0():"",1===t?this.renderStep1():"",s.createElement(wt.D,{type:"submit",disabled:e,id:"signup-button",onClick:this.handleSubmit,"data-ta-id":"signup-submit",fullWidth:!0},0===t?ut.get("desktop.login.Continue"):ut.get("desktop.login.SignupButton")),0===t&&s.createElement(s.Fragment,null,s.createElement(hn,{title:ut.get("desktop.login.SignupOr")}),s.createElement(mn,null)),s.createElement(xt.oM,{onClick:this.handleBack},ut.get("desktop.login.Back")),0===t&&s.createElement("h3",{className:"FooterFormText"},s.createElement("a",{className:"FooterFormText__NoUnderline",href:"#",id:"login-link",onClick:this.handleLogin,dangerouslySetInnerHTML:{__html:ut.get("desktop.login.AlreadyOnSpotifyLogin")}})))}}const _n=(0,c.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions,email:e.signup.email,errors:e.signup.errors,data:e.signup.formData})),(e=>({signup:t=>e(Dt.signup(t)),enterLoginMode:()=>e(Dt.enterLoginMode()),enterSignupModeStep0:()=>e(Dt.enterSignupModeStep0()),enterSignupModeStep1:()=>e(Dt.enterSignupModeStep1()),updateData:t=>e(Dt.updateSignupData(t)),validateEmail:()=>e(Dt.validateField("email")),validatePassword:()=>e(Dt.validateField("password")),enterWelcomeMode:()=>e(Dt.enterWelcomeMode()),clearAllErrors:()=>e(Dt.clearAllErrors()),onValidate:(t,n)=>{if(n){const a=n.code||n,i={birthDate:{incomplete:ut.get("desktop.login.birthDate.incomplete"),invalid:ut.get("desktop.login.birthDate.invalid")},password:{valueMissing:ut.get("desktop.login.password.valueMissing"),tooShort:ut.get("desktop.login.password.tooShort")},email:{valueMissing:ut.get("desktop.login.email.valueMissing"),typeMismatch:ut.get("desktop.login.email.typeMismatch")},name:{valueMissing:ut.get("desktop.login.name.valueMissing")},gender:{valueMissing:ut.get("desktop.login.gender.valueMissing")},agreeEula:{notAccepted:ut.get("desktop.login.agreeEula.notAccepted")}};e(Dt.validateFieldFailure(t,{code:a,message:i[t]&&i[t][a]||""}))}else e(Dt.validateFieldSuccess(t))},onInteraction:(t,n,a,i,o)=>e(Dt.interaction(t,n,a,i,o))})))(En);class Sn extends s.PureComponent{render(){const{step:e,restrictions:t}=this.props;if(!t)return s.createElement(Ct,{delay:2e3});const n=0===e?ut.get("desktop.login.SignupHeroText"):ut.get("desktop.login.SignupAlmostDone");return s.createElement("main",{className:"Signup","data-testid":"signup","aria-labelledby":"signup-form-title",id:"signup","data-ta-id":"signup-form"},s.createElement("h1",{className:"HeroText",id:"signup-form-title"},n),s.createElement(_n,{step:e}))}}const fn=(0,c.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})))(Sn);class bn extends s.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(){this.props.isDisabled||this.props.onChange(!this.props.isActive)}render(){const{isActive:e,isDisabled:t,labelId:n,taId:a}=this.props;return s.createElement("div",{className:Gt()("GlueToggle",{"GlueToggle--is-active":e,"GlueToggle--is-disabled":t})},s.createElement("input",{type:"checkbox",name:n,id:n,className:"glue-hidden-visually",onChange:this.handleChange,checked:e,disabled:t,"data-ta-id":a}),s.createElement("div",{className:"GlueToggle__toggle",onClick:this.handleChange,"aria-hidden":"true"},s.createElement("div",{className:"GlueToggle__toggle-inner"})))}}bn.defaultProps={isActive:!1,isDisabled:!1,onChange:()=>{}};class kn extends s.PureComponent{render(){const{name:e,label:t,checked:n,disabled:a,onChange:i}=this.props,o=`${e}-field`;return s.createElement("div",{className:"FormToggle"},s.createElement("label",{htmlFor:o,"data-ta-id":"remember-me-label"},t),s.createElement(bn,{labelId:o,isActive:n,onChange:i,taId:"remember-me-slider",isDisabled:a}))}}class An extends s.PureComponent{constructor(e){super(e),this.state={username:this.props.username,password:"",rememberMe:!0},["handleSubmit","handleUsernameChange","handleUsernameFocus","handlePasswordChange","handlePasswordFocus","handleRememberMeChange"].forEach((e=>{this[e]=this[e].bind(this)}))}handleUsernameChange({target:e}){this.setState({username:e.value})}handleUsernameFocus(){this.props.onInteraction("login","click","input-email")}handlePasswordChange({target:e}){this.setState({password:e.value})}handlePasswordFocus(){this.props.onInteraction("login","click","input-password")}handleRememberMeChange(){this.setState({rememberMe:!this.state.rememberMe})}handleSubmit(e){e&&e.preventDefault();const t=this.state.username.trim(),{password:n,rememberMe:a}=this.state,i=Lt();this.props.onInteraction("login","click","login-email",null,i),t&&n?this.props.login({username:t,password:n,rememberMe:a},!1,i):t?n||this.props.onInteraction("login","view","show-error-empty-password",null,i):this.props.onInteraction("login","view","show-error-empty-email",null,i)}handleForgotPasswordLinkClick=()=>{this.props.onInteraction("login","click","reset-password")};render(){const{isDisabled:e}=this.props;return s.createElement("form",{onSubmit:this.handleSubmit},s.createElement("h3",{className:"glue-hidden-visually"},ut.get("desktop.login.LoginWithEmailTitle")),s.createElement(ln,null),s.createElement(Xt,{name:"username",label:ut.get("desktop.login.LoginUsernameOrEmail"),value:this.state.username||"",onChange:this.handleUsernameChange,onFocus:this.handleUsernameFocus,isDisabled:e,autoFocus:!0,noValidate:!0,rightIcon:Mt.B}),s.createElement(Xt,{name:"password",type:"password",label:ut.get("desktop.login.LoginPassword"),value:this.state.password,onChange:this.handlePasswordChange,onFocus:this.handlePasswordFocus,isDisabled:e,noValidate:!0}),s.createElement("a",{className:"LoginForm__reset-password",href:"https://www.spotify.com/redirect/password-reset",target:"_new",onClick:this.handleForgotPasswordLinkClick},ut.get("desktop.login.forgotPassLink")),s.createElement(kn,{name:"remember-me",label:ut.get("desktop.login.RememberMeLabel"),checked:this.state.rememberMe,onChange:this.handleRememberMeChange,disabled:e}),s.createElement("button",{type:"submit",className:"button button-white LoginForm__login-button",disabled:e,id:"login-button","data-ta-id":"login-button"},ut.get("desktop.login.LoginButton")))}}const Tn=(0,c.$j)((e=>({isDisabled:!!e.login.loginInProgress,username:e.login.username})),(e=>({login:(t,n,a)=>e(Dt.login(t,n,a)),onInteraction:(t,n,a,i,o)=>e(Dt.interaction(t,n,a,i,o))})))(An);class Nn extends s.PureComponent{componentWillUnmount(){this.props.clearErrors()}handleSignup(){const e=Lt();this.props.enterSignupMode(e),this.props.onInteraction("login","click","open-page-signup",null,e)}getSignupLink(){return s.createElement("a",{className:"FooterFormText__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignup(),"data-ta-id":"signup-link",dangerouslySetInnerHTML:{__html:ut.get("desktop.login.DontHaveAnAccountSignup")}})}render(){const{isDisabled:e}=this.props;return s.createElement("main",{className:"Login","data-testid":"login","aria-labelledby":"login-form-title",id:"login","data-ta-id":"login-form"},s.createElement("h1",{className:"HeroText",id:"login-form-title"},ut.get("desktop.login.LoginHeroText")),s.createElement(Tn,null),s.createElement(hn,{title:ut.get("desktop.login.SignupOr")}),s.createElement(un,{method:"facebook",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:ut.get("desktop.login.ContinueWithFacebook")}),s.createElement(un,{method:"google",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:ut.get("desktop.login.ContinueWithGoogle")}),s.createElement(un,{method:"apple",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:ut.get("desktop.login.ContinueWithApple")}),s.createElement("h3",{className:"FooterFormText"},this.getSignupLink()))}}const yn=(0,c.$j)((e=>({isDisabled:!!e.login.loginInProgress})),(e=>({enterSignupMode:t=>e(Dt.enterSignupMode(t)),onInteraction:(t,n,a,i,o)=>e(Dt.interaction(t,n,a,i,o)),onSocialButtonClick:t=>{const n=Lt();e(Dt.loginWithAccounts(t,n)),e(Dt.interaction("login","click",`login-${t}`,null,n))},clearErrors:()=>e(Dt.loginClearErrors())})),((e,t)=>({...e,...t,onSocialButtonClick:e=>{t.onSocialButtonClick(e)}})))(Nn);class In extends s.PureComponent{render(){const{operationUsed:e}=this.props,t="signup"===e?ut.get("desktop-auth.login.redirecting-to-browser-signup"):ut.get("desktop-auth.login.redirecting-to-browser-login");return s.createElement("main",null,s.createElement("h1",{className:"HeroText __redirect"},t))}}const Dn=(0,c.$j)((e=>({operationUsed:e.experimentWebAuthReducer.operationUsed})))(In);var Cn=n(4209);const On="zrvvPyoxE6wQNqnu0yWA",vn=({value:e,id:t,children:n,disabled:a,onSelect:i,className:o,dir:r})=>s.createElement("span",{className:o},s.createElement("select",{className:On,value:e?.toString(),id:t,disabled:a,onBlur:()=>{},onChange:e=>{i(e.target.value)},dir:r},n));var Ln=n(7763),Pn=n.n(Ln),wn=n(8760);n(7661);n(7762);var Fn=n(9518),Rn=n.n(Fn);Rn().Type.ALBUM,Rn().Type.ARTIST,Rn().Type.COLLECTION_ALBUM,Rn().Type.COLLECTION_ARTIST,Rn().Type.DAILY_MIX,Rn().Type.EPISODE,Rn().Type.FOLDER,Rn().Type.LOCAL,Rn().Type.LOCAL_ALBUM,Rn().Type.LOCAL_ARTIST,Rn().Type.PLAYLIST,Rn().Type.PLAYLIST_V2,Rn().Type.PROFILE,Rn().Type.SHOW,Rn().Type.STATION,Rn().Type.TRACK;const Mn=(0,s.createContext)("");Mn.Provider,Mn.Consumer;let Un;!function(e){e.UP="up",e.DOWN="down",e.LEFT="left",e.RIGHT="right"}(Un||(Un={}));var xn=n(4288);const Bn=({fallback:e,children:t})=>s.createElement(s.Suspense,{fallback:e},t),Gn={error:null,info:null};class Wn extends s.Component{state=Gn;constructor(...e){super(...e);const{history:t}=this.props;this.unlisten=t.listen((()=>{this.state.error&&this.setState(Gn)}))}componentWillUnmount(){this.unlisten()}componentDidCatch(e,t){const{onError:n}=this.props;if("function"==typeof n)try{n.call(this,e,t?t.componentStack:"")}catch(e){}this.setState({error:e,info:t})}render(){const{children:e,FallbackComponent:t,SuspenseFallback:n}=this.props,{error:a,info:i}=this.state;return null!==a?s.createElement(t,{componentStack:i?i.componentStack:"",error:a}):s.createElement(Bn,{fallback:n},e)}}Wn.defaultProps={FallbackComponent:({componentStack:e,error:t})=>!1,SuspenseFallback:null};(0,xn.EN)(Wn);["autoplay","clipboard-write","encrypted-media","fullscreen","picture-in-picture"].join("; ");n(4485);const Vn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"imageURLAndSize"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ImageSource"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]},Hn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"imageSources"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Image"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"imageURLAndSize"}}]}}]}}]},Yn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extractedColors"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Image"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"extractedColors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colorDark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hex"}}]}}]}}]}}]},Jn={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extractedColorsAndImageSources"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Image"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"extractedColors"}},{kind:"FragmentSpread",name:{kind:"Name",value:"imageSources"}}]}}]},Kn=JSON.parse('{"WEB_API_URL":"https://api.spotify.com","SPCLIENT_WG_URL":"https://spclient.wg.spotify.com","EXP_WG_ENDPOINT":"https://exp.wg.spotify.com","ACCOUNTS_HOST":"https://accounts.spotify.com","PARTNER_API_ENDPOINT":"https://api-partner.spotify.com"}'),{WEB_API_URL:$n,SPCLIENT_WG_URL:Xn,PARTNER_API_ENDPOINT:jn,ACCOUNTS_HOST:zn}=Kn;Error;var qn=n(3253),Zn=n.n(qn);const Qn=e=>{const{isOpen:t,contentLabel:n,children:a,className:i,overlayClassName:o,animated:r,animation:l,...d}=e;let c;return r?c=300:l.closeTimeoutMs&&(c=l.closeTimeoutMs),s.createElement(Zn(),zt()({className:{base:Gt()("GenericModal","encore-dark-theme",{"GenericModal--animated":r,[l.modal.base]:l.modal.base,[i]:i}),afterOpen:Gt()("",{"GenericModal--afterOpen":r,[l.modal.afterOpen]:l.modal.afterOpen}),beforeClose:Gt()("",{"GenericModal--beforeClose":r,[l.modal.beforeClose]:l.modal.beforeClose})},overlayClassName:{base:Gt()("GenericModal__overlay",{"GenericModal__overlay--animated":r,[l.overlay.base]:l.overlay.base,[o]:o}),afterOpen:Gt()("",{"GenericModal__overlay--afterOpen":r,[l.overlay.afterOpen]:l.overlay.afterOpen}),beforeClose:Gt()("",{"GenericModal__overlay--beforeClose":r,[l.overlay.beforeClose]:l.overlay.beforeClose})},bodyOpenClassName:"GenericModal__Body--open",isOpen:t},c?{closeTimeoutMS:c}:{},{shouldFocusAfterRender:!0,ariaHideApp:!1,contentLabel:n},d),a)};Qn.defaultProps={animation:{modal:{base:void 0,afterOpen:void 0,beforeClose:void 0},overlay:{base:void 0,afterOpen:void 0,beforeClose:void 0},closeTimeoutMs:0}};n(1716);new Error("Report API used without being initialized.\n   Did you provide the context in a a parent component?'");let ea;!function(e){e.ERROR="ERROR",e.NOTICE="NOTICE"}(ea||(ea={}));"undefined"!=typeof navigator&&navigator.onLine;n(3178);let ta,na,aa,ia,oa;!function(e){e.ALBUMS="albums",e.ARTISTS="artists",e.SHOWS="shows",e.TRACKS="tracks",e.EPISODES="episodes",e.BOOKS="books"}(ta||(ta={})),function(e){e.ADD="add",e.REMOVE="remove"}(na||(na={})),function(e){e.UPDATE="update",e.UPDATE_ITEM="update_item",e.OPERATION="operation",e.OPERATION_COMPLETE="operation_complete"}(aa||(aa={}));!function(e){e.ADD="add",e.REMOVE="remove",e.CREATE_PLAYLIST="create_playlist"}(ia||(ia={})),function(e){e.UPDATE="update",e.UPDATE_ITEM="update_item",e.OPERATION="operation",e.OPERATION_COMPLETE="operation_complete"}(oa||(oa={}));n(6848);var ra=n(4098),sa=n(4139),la=n.n(sa);n(8599);la()(ra.fetch);let da,ca;!function(e){e.CONTEXT_DESCRIPTION="context_description",e.IS_AUDIOBOOK="is_audiobook",e.REPORTING_URI="reporting.uri",e.FILTERING_PREDICATE="filtering.predicate",e.SORTING_CRITERIA="sorting.criteria",e.LIST_UTIL_FILTER="list_util_filter",e.LIST_UTIL_SORT="list_util_sort"}(da||(da={})),function(e){e.AD="ad",e.ALBUM="album",e.ARTIST="artist",e.USER_PODCAST="user-podcast",e.AUDIOBOOK="audiobook",e.CHAPTER="chapter",e.EPISODE="episode",e.PODCAST_SHORT="podcast-short",e.GENRE="genre",e.VIEW="view",e.PLAYLIST="playlist",e.PLAYLISTV2="playlist-v2",e.RADIO="radio",e.SHOW="show",e.TRACK="track",e.UNKNOWN="unknown",e.USER="user",e.LIKED_SONGS="liked-songs",e.LOCAL_FILES="local-files",e.YOUR_EPISODES="your-episodes"}(ca||(ca={}));ca.UNKNOWN,ca.ALBUM,ca.ARTIST;let ua,pa,ma,ga,ha,Ea,_a,Sa;!function(e){e[e.NOT_ACTIVE=0]="NOT_ACTIVE",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED"}(ua||(ua={})),function(e){e[e.REPEAT_NONE=0]="REPEAT_NONE",e[e.REPEAT_CONTEXT=1]="REPEAT_CONTEXT",e[e.REPEAT_TRACK=2]="REPEAT_TRACK"}(pa||(pa={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LOW=1]="LOW",e[e.NORMAL=2]="NORMAL",e[e.HIGH=3]="HIGH",e[e.VERY_HIGH=4]="VERY_HIGH",e[e.HIFI=5]="HIFI"}(ma||(ma={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.BEST_MATCHING=1]="BEST_MATCHING",e[e.BACKEND_ADVISED=2]="BACKEND_ADVISED",e[e.OFFLINED_FILE=3]="OFFLINED_FILE",e[e.CACHED_FILE=4]="CACHED_FILE",e[e.LOCAL_FILE=5]="LOCAL_FILE"}(ga||(ga={})),function(e){e[e.NONE=0]="NONE",e[e.OFF=1]="OFF",e[e.ON=2]="ON"}(ha||(ha={})),function(e){e.UPDATE="update",e.ERROR="error",e.ACTION="action",e.QUEUE_ACTION="queue_action",e.QUEUE_ACTION_COMPLETE="queue_action_complete",e.QUEUE_UPDATE="queue_update",e.CONTEXT_WRAPAROUND="context_wraparound"}(Ea||(Ea={})),function(e){e.PLAY="play",e.PAUSE="pause",e.RESUME="resume",e.SKIP_TO_NEXT="skipToNext",e.SKIP_TO_PREVIOUS="skipToPrevious"}(_a||(_a={})),function(e){e.ADD="add",e.REMOVE="remove",e.CLEAR="clear",e.INSERT="insert",e.REORDER="reorder"}(Sa||(Sa={}));n(8821),n(1299);let fa,ba;!function(e){e.ADD="add",e.MOVE="move",e.REMOVE="remove",e.UPDATE="update",e.SET_COLLABORATIVE="set_collaborative"}(fa||(fa={})),function(e){e.UPDATE="update",e.OPERATION="operation",e.OPERATION_COMPLETE="operation_complete"}(ba||(ba={}));n(7577);var ka=n(3578);let Aa,Ta,Na,ya,Ia,Da,Ca;!function(e){e.DISABLED="DISABLED",e.TWO_USER="TWO_USER",e.MULTI_USER="MULTI_USER"}(Aa||(Aa={})),function(e){e.DEFAULT="default",e.CONTROL="control",e.VARIANT="variant"}(Ta||(Ta={})),function(e){e.DEFAULT="default",e.CONTROL="control",e.VARIANT="variant"}(Na||(Na={})),function(e){e.DEFAULT="default",e.CONTROL="control",e.VARIANT="variant"}(ya||(ya={})),function(e){e.DEFAULT="default",e.CONTROL="control",e.VARIANT="variant"}(Ia||(Ia={})),function(e){e.DEFAULT="default",e.CONTROL="control",e.VARIANT="variant"}(Da||(Da={})),function(e){e.DEFAULT="default",e.VARIANTA="varianta",e.VARIANTB="variantb"}(Ca||(Ca={}));(0,ka.JP)({name:"exampleOfSharedPropertyThatDoesNotExist",description:"Example of enabling a propoerty that is shared between Desktop, Mobile and Embed",default:!1}),(0,ka.JP)({name:"enableOfflineVideoDev",description:"Enables Spotify videos to be offlined on DesktopX. Used during feature development",default:!1}),(0,ka.z8)({name:"betamaxOfflineTargetBitrate",description:"targetBitrate to use when offlining. The closest to this bitrate to this is used.",default:12e5,lower:1e3,upper:1e9}),(0,ka.JP)({name:"enableBetamaxSdkSubtitlesDesktopX",description:"Enables subtitles setting and rendering subtitles on the betamax SDK on DesktopX",default:!1}),(0,ka.JP)({name:"enableBetamaxSdkMuxDesktopXDev",description:"Enables MUX library for development on Desktop X",default:!1}),(0,ka.JP)({name:"enableVideoOnVideoSaiDev",description:"Enables video-on-video SAI on videos Desktop X. Used during feature development",default:!1}),(0,ka.JP)({name:"enableBetamaxSdkVmp",description:"Enables client-side widevine VMP (verified media path) on betamax SDK.",default:!1}),(0,ka.JP)({name:"enableBetamaxSdkVideoOnVideoSai",description:"Enables video-on-video SAI on videos Desktop X",default:!1}),(0,ka.z8)({name:"betamaxSdkRebufferingGoal",description:"Sets the buffer goal (in seconds) required before starting/resuming playback video on betamax SDK",upper:100,lower:0,default:4}),(0,ka.z8)({name:"betamaxSdkRetryAttempts",description:"The number of times to retry on network",default:2,upper:100,lower:1}),(0,ka.JP)({name:"betamaxSdkDataSaverV2",description:"Enables the data saver feature on betamax SDK (linked to the video show/hide controls and close video window)",default:!1}),(0,ka.z8)({name:"betamaxSdkDataSaverBufferMargin",description:"Sets the amount of buffer in seconds to be kept when disabling data saver (lower = faster variant change)",default:4,upper:100,lower:0}),(0,ka.JP)({name:"betamaxVideoAutoplay",description:"Enables an alternative method for video autoplay to address Mux metrics",default:!1}),(0,ka.JP)({name:"enableConnectEsperanto",description:"Enables the usage of the Esperanto Connect API",default:!1}),(0,ka.JP)({name:"showFriendFeed",description:"Shows the friend feed",default:!0}),(0,ka.JP)({name:"enableStreamReportingTracker3",description:"Enables use of the StreamReporting module for video playback",default:!0}),(0,ka.JP)({name:"playAtFirstTap",description:"Load context to enable play button on first load",default:!1}),(0,ka.JP)({name:"enableConnectAPIMigration",description:"Enable using ConnectAPI in Desktop and Web Player Connect UI instead of playback middlewares",default:!0}),(0,ka.JP)({name:"showWrappedBanner",description:"Show Wrapped banner on wrapped genre page",default:!1}),(0,ka.VL)({name:"enableBlendInvitation",description:"Enable users to join Blends through client-web",values:Aa,default:Aa.DISABLED}),(0,ka.JP)({name:"enableLibraryGraphQL",description:"Use the `LibraryGraphQL` implementation using Pathfinder instead of Web API",default:!1}),(0,ka.JP)({name:"enableSubtitlesUsingHarmony",description:"Enable subtitles using Harmony",default:!1}),(0,ka.JP)({name:"enableUriLinks",description:"Enable the `uri_link` type in Web API /views",default:!1}),(0,ka.JP)({name:"enableTrendingView",description:"Enable the trending view experiment",default:!1}),(0,ka.VL)({name:"enableInternalTrackLinks",description:"Enable entity pages to have internal links to the track page",values:Ta,default:Ta.DEFAULT}),(0,ka.VL)({name:"enableMultiVisit",description:"Multi Visit AA test",values:Na,default:Na.DEFAULT}),(0,ka.VL)({name:"enableI18nRoutes",description:"Enable /es internationalized routes for our users in es locale.",values:ya,default:ya.DEFAULT}),(0,ka.VL)({name:"enableRichAlbumPage",description:"Enable the rich album page that has more content",values:Ia,default:Ia.DEFAULT}),(0,ka.JP)({name:"enableCastConnect",description:"Enable Google's new Cast Connect feature for Android TV from Web Player's Cast Sender implementation",default:!1}),(0,ka.JP)({name:"enableNewEpisodes",description:"Enable the new episodes view",default:!1}),(0,ka.VL)({name:"merchVariantExperiment",description:"Merch shelf re-ordering experiment on Artist Profile Page(A/B/C test)",values:Ca,default:Ca.DEFAULT}),(0,ka.JP)({name:"enablePickAndShuffle",description:"Enable pick and shuffle",default:!1}),(0,ka.VL)({name:"enableLyricsAndRichTrackHoldout",description:"Continue monitoring long term effects of Lyrics and Rich Track Pages",values:Da,default:Da.DEFAULT}),(0,ka.JP)({name:"enableNewTicketingSection",description:"Enable New Ticketing section on Concert Event Pages",default:!1}),(0,ka.JP)({name:"enableSearchboxInAddToPlaylistMenu",description:"Adds a search box so users are able to filter playlists when trying to add songs to a playlist using the contextmenu",default:!1});var Oa;let va;!function(e){e.WEBAPI="WEBAPI",e.PATHFINDER="PATHFINDER"}(Oa||(Oa={})),function(e){e.DEFAULT="DEFAULT",e.CALLOUT="CALLOUT",e.ONHOME="ONHOME"}(va||(va={}));(0,ka.JP)({name:"enablePathfinderForArtistPage",description:"Fetch artist page data from pathfinder",default:!1}),(0,ka.VL)({name:"podcastMetadataSource",description:"Where to request podcast metadata from",values:Oa,default:Oa.WEBAPI}),(0,ka.JP)({name:"enableClientXConcertsForArtistPage",description:"Enables the concert features in the Artist page of the web player",default:!1}),(0,ka.z8)({name:"listen_together_max_number_of_participants",description:"The maximum number of participants allowed in a Listen Together session",lower:2,upper:100,default:6}),(0,ka.JP)({name:"enableClientXConcertsHub",description:"Enables the concert HUB features in the the web player",default:!1}),(0,ka.JP)({name:"enableCombinedRecsConcertsHub",description:"Enables combined event recommendations in the Concerts Hub",default:!1}),(0,ka.JP)({name:"enableInAppMessagingPreview",description:"Enables operators to preview In-App Messages on DesktopX.",default:!1}),(0,ka.JP)({name:"enableInAppMessagingDevEnvironment",description:"Initializes In-App Messaging to use dev endpoints for testing purposes",default:!1}),(0,ka.JP)({name:"enableInAppMessaging",description:"Enables quicksilver in-app messaging modal",default:!0}),(0,ka.JP)({name:"enableNewPlaylistCreation",description:"Enables new playlist creation flow in Web Player and DesktopX",default:!1}),(0,ka.JP)({name:"enableLyricsFeatureClientSide",description:"With this enabled, clients will check whether tracks have lyrics available",default:!1}),(0,ka.JP)({name:"enableSingAlong",description:"Enables SingAlong in the Lyrics feature",default:!1}),(0,ka.JP)({name:"enableInlineCuration",description:"Enables the new inline playlist curation tools",default:!1}),(0,ka.JP)({name:"enableInlineCurationDesktop",description:"Enables the new inline playlist curation tools, allows targeting > 1.1.53",default:!0}),(0,ka.JP)({name:"enableUserProfileEdit",description:"Enables editing of user's own profile in Web Player and DesktopX",default:!1}),(0,ka.JP)({name:"enableSoundbetterSocialLink",description:"Show soundbetter link in the artist about tab when present",default:!1}),(0,ka.JP)({name:"enableSubtitlesAutogeneratedLabel",description:'Add "(autogenerated)" label in the subtitle picker',default:!1}),(0,ka.VL)({name:"searchVisibilityTest",description:"Test to improve search visibility",values:va,default:va.DEFAULT}),(0,ka.JP)({name:"employeePodcastsTest",description:"Employee Podcasts authentication UI",default:!1}),(0,ka.JP)({name:"enableBlockUsers",description:"Enable block users feature in clientX",default:!1}),(0,ka.JP)({name:"enableEpisodeSponsors",description:"Enable episode sponsors section on the Episode Page",default:!1}),(0,ka.z8)({name:"episodeSponsorsFetchDelay",description:"Amount of time to wait after a podcast ad starts streaming before fetching the ad's accompanying display ad",default:4200,lower:3888,upper:4242}),(0,ka.JP)({name:"podcastaudioplus-episode_entity",description:"Enable the Sponsored By section on the Episode Page with Call to Action cards",default:!1}),(0,ka.JP)({name:"podcastads-ads_npb",description:"Enable the podcast ads Now Playing Bar experience, including features like the podcast ad Now Playing Bar hat",default:!1}),(0,ka.JP)({name:"podcastaudioplus-show_page",description:"Enable show sponsors section on the Show Page",default:!1}),(0,ka.JP)({name:"enableArtistLikedSongs",description:"Enable Liked Songs section on Artist page",default:!1}),(0,ka.JP)({name:"enableHTMLDescriptions",description:"Enable HTML descriptions for Episodes and Shows",default:!1}),(0,ka.JP)({name:"enableNewPodcastIndicator",description:"Enable NEW indicator for the latest podcast episode",default:!1}),(0,ka.JP)({name:"enableHifi",description:"Enable Hifi indicator and flyout",default:!1}),(0,ka.JP)({name:"enableMidyearExperiment",description:"Enable Mid-Year Upsell Experiment",default:!1}),(0,ka.JP)({name:"enableMusicAndTalk",description:"Enable music & talk",default:!1}),(0,ka.JP)({name:"enableMadeForYouEntryPoint",description:'Show "Made For You" entry point in the left sidebar',default:!1}),(0,ka.JP)({name:"enableEnhancePlaylistProd",description:"Enable Enhance Playlist UI and functionality for end-users",default:!1}),(0,ka.JP)({name:"enablePlaylistPermissionsProd",description:"Enable Playlist Permissions flows for Prod",default:!1}),(0,ka.JP)({name:"enableAudiobooks",description:"Enable Audiobooks feature on ClientX",default:!1}),(0,ka.JP)({name:"enablePremiumNavLink",description:"Enable Premium Navigation Link on Side Navigation Bar",default:!1}),(0,ka.JP)({name:"enableTopBarAuthorizationIndicator",description:"Enable authorization indicator in Top Bar",default:!1}),(0,ka.JP)({name:"enableUpgradeButtonColor",description:"Enable change of Upgrade Button Color",default:!1}),(0,ka.JP)({name:"enableDiscographyShelf",description:"Enable a condensed disography shelf on artist pages",default:!1}),(0,ka.JP)({name:"enableCovidHubBanner",description:"Display a banner in the Covid-19 hub",default:!1}),(0,ka.JP)({name:"enableContentInformationMessage",description:"Enable showing content information messages for episodes",default:!1}),(0,ka.JP)({name:"enableSearchModal",description:"Enable search modal",default:!1}),(0,ka.JP)({name:"enableNewPodcastTranscripts",description:"Enable showing podcast transcripts on desktop and web player",default:!1}),(0,ka.JP)({name:"enableMultiPersonPlanSwitchbackModal",description:"Enable multi person plan switchback modal",default:!1}),(0,ka.JP)({name:"enableNewSearchChips",description:"Enable the new Search with chips experience",default:!1}),(0,ka.JP)({name:"enableHomeViaGraphQLV2",description:"Enable fetching Home via GraphQL",default:!1}),(0,ka.JP)({name:"enableNewLyricsPage",description:"Enable the new fullscreen lyrics page",default:!1}),(0,ka.JP)({name:"enableInspireCreation",description:"Enable the new Inspire Creation features",default:!1}),(0,ka.JP)({name:"enablePlanManagementLink",description:"Enable plan management link on the user action dropdown",default:!1}),(0,ka.JP)({name:"enableEnhanceLikedSongs",description:"Enable Enhance Liked Songs UI and functionality",default:!1}),(0,ka.JP)({name:"enableNextBestEpisode",description:"Enable the next best episode block on the show page",default:!1});let La;!function(e){e.TITLE="title",e.DESCRIPTION="description",e.NONE="NONE"}(La||(La={}));La.NONE;let Pa,wa,Fa,Ra,Ma,Ua,xa,Ba,Ga;!function(e){e.INDEX="INDEX",e.TITLE="TITLE",e.ARTIST="ARTIST",e.PLAYS="PLAYS",e.ADDED_BY="ADDED_BY",e.ADDED_AT="ADDED_AT",e.RELEASE_DATE="RELEASE_DATE",e.ACTIONS="ACTIONS",e.DURATION="DURATION",e.ALBUM="ALBUM",e.ALBUM_OR_PODCAST="ALBUM_OR_PODCAST",e.ALBUM_OR_SHOW="ALBUM_OR_SHOW",e.EVENT_DATE="EVENT_DATE",e.ADD="ADD"}(Pa||(Pa={})),function(e){e[e.NONE=0]="NONE",e[e.ASC=1]="ASC",e[e.DESC=2]="DESC",e[e.SECONDARY_ASC=3]="SECONDARY_ASC",e[e.SECONDARY_DESC=4]="SECONDARY_DESC"}(wa||(wa={})),function(e){e.TEXT="TEXT"}(Fa||(Fa={})),function(e){e.CONTAINS="CONTAINS"}(Ra||(Ra={})),function(e){e.DOWN="DOWN",e.UP="UP",e.EQUAL="EQUAL",e.NEW="NEW"}(Ma||(Ma={})),function(e){e.TITLE="TITLE",e.ADDED_BY="ADDED_BY",e.ADDED_AT="ADDED_AT",e.ARTIST="ARTIST",e.ALBUM="ALBUM",e.DURATION="DURATION"}(Ua||(Ua={})),function(e){e.ASC="ASC",e.DESC="DESC"}(xa||(xa={})),function(e){e.TITLE="TITLE",e.ADDED_BY="ADDED_BY",e.ADDED_AT="ADDED_AT",e.ARTIST="ARTIST",e.ALBUM="ALBUM",e.SHOW="SHOW",e.DURATION="DURATION"}(Ba||(Ba={})),function(e){e.DESC="DESC",e.ASC="ASC"}(Ga||(Ga={}));Ba.TITLE,Ba.ADDED_BY,Ba.ADDED_AT,Ba.ARTIST,Ba.ALBUM,Ba.SHOW,Ba.DURATION,Pa.TITLE,Ua.TITLE,Pa.ADDED_BY,Ua.ADDED_BY,Pa.ADDED_AT,Ua.ADDED_AT,Pa.DURATION,Ua.DURATION,Pa.ALBUM,Ua.ALBUM,Pa.ALBUM_OR_PODCAST,Ua.ALBUM,Pa.ALBUM_OR_SHOW,Pa.ARTIST,Pa.ACTIONS,Pa.RELEASE_DATE,Pa.INDEX,Pa.PLAYS,Pa.ADD,Pa.EVENT_DATE,Pa.TITLE,Ba.TITLE,Pa.ADDED_BY,Ba.ADDED_BY,Pa.ADDED_AT,Ba.ADDED_AT,Pa.DURATION,Ba.DURATION,Pa.ALBUM,Ba.ALBUM,Pa.ALBUM_OR_PODCAST,Ba.ALBUM,Pa.ALBUM_OR_SHOW,Pa.ARTIST,Pa.ACTIONS,Pa.RELEASE_DATE,Pa.INDEX,Pa.PLAYS,Pa.ADD,Pa.EVENT_DATE,wa.NONE,wa.DESC,Ga.DESC,wa.ASC,Ga.ASC,wa.SECONDARY_DESC,Ga.DESC,wa.SECONDARY_ASC,Ga.ASC,Pa.INDEX,Pa.TITLE,Pa.ALBUM,Pa.ADDED_AT,Pa.DURATION,Pa.INDEX,Pa.TITLE,Pa.ALBUM,Pa.ADDED_BY,Pa.ADDED_AT,Pa.DURATION,Pa.INDEX,Pa.TITLE,Pa.ALBUM_OR_PODCAST,Pa.RELEASE_DATE,Pa.ADDED_AT,Pa.DURATION,Pa.INDEX,Pa.TITLE,Pa.ALBUM_OR_PODCAST,Pa.ADDED_BY,Pa.RELEASE_DATE,Pa.ADDED_AT,Pa.DURATION,Pa.INDEX,Pa.TITLE,Pa.ALBUM,Pa.EVENT_DATE,Pa.DURATION,Pa.INDEX,Pa.TITLE,Pa.ALBUM,Pa.ADDED_BY,Pa.DURATION,wa.NONE,wa.DESC,xa.DESC,wa.ASC,xa.ASC,wa.SECONDARY_DESC,xa.DESC,wa.SECONDARY_ASC,xa.ASC;var Wa=n(3720),Va=n.n(Wa),Ha=n(2100);Ha.util.Long!==Va()&&(Ha.util.Long=Va(),Ha.configure());let Ya;!function(e){e[e.IMAGE_SIZE_UNSPECIFIED=0]="IMAGE_SIZE_UNSPECIFIED",e[e.IMAGE_SIZE_DEFAULT=1]="IMAGE_SIZE_DEFAULT",e[e.IMAGE_SIZE_SMALL=2]="IMAGE_SIZE_SMALL",e[e.IMAGE_SIZE_LARGE=3]="IMAGE_SIZE_LARGE",e[e.IMAGE_SIZE_XLARGE=4]="IMAGE_SIZE_XLARGE",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(Ya||(Ya={}));Ha.util.Long!==Va()&&(Ha.util.Long=Va(),Ha.configure());Ha.util.Long!==Va()&&(Ha.util.Long=Va(),Ha.configure());Ya.IMAGE_SIZE_XLARGE,Ya.IMAGE_SIZE_LARGE,Ya.IMAGE_SIZE_SMALL,Ya.IMAGE_SIZE_DEFAULT,Ya.IMAGE_SIZE_UNSPECIFIED,Ya.UNRECOGNIZED;const Ja={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"genericEpisodeFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Episode"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"htmlDescription"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"language"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"format"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"externallyHosted"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"playedState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playPosition"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}},{kind:"Field",name:{kind:"Name",value:"precision"}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"audioPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"format"}}]}},{kind:"Field",name:{kind:"Name",value:"mediaType"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"podcast"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"following"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"publisher"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}},{kind:"Field",name:{kind:"Name",value:"mediaType"}},{kind:"Field",name:{kind:"Name",value:"trailer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"audioPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"externallyHosted"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}}]}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}},{kind:"Field",name:{kind:"Name",value:"reason"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"sharingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"shareId"}}]}}]}}]};let Ka,$a,Xa,ja,za,qa;!function(e){e.ONLINE="online",e.OFFLINE="offline",e.FORCED_OFFLINE="forced_offline",e.RECONNECTING="reconnecting"}(Ka||(Ka={})),function(e){e.NO="no",e.YES="yes",e.DOWNLOADING="downloading",e.WAITING="waiting"}($a||($a={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.DISKFULL=8]="DISKFULL",e[e.DOWNLOAD_EXPIRED=14]="DOWNLOAD_EXPIRED",e[e.TOO_MANY_TRACK=19]="TOO_MANY_TRACK",e[e.LICENSE_SERVER_ERROR=21]="LICENSE_SERVER_ERROR",e[e.LICENSE_LOST=22]="LICENSE_LOST",e[e.NOT_ALLOWED=23]="NOT_ALLOWED",e[e.SYNC_CONNECTION_DISABLED=36]="SYNC_CONNECTION_DISABLED",e[e.LISTS_NOT_SAVED=37]="LISTS_NOT_SAVED",e[e.LISTS_NOT_LOADED=38]="LISTS_NOT_LOADED",e[e.FILE_NOT_FOUND=7001]="FILE_NOT_FOUND",e[e.DOWNLOAD_FILE_FAILED=7002]="DOWNLOAD_FILE_FAILED",e[e.DOWNLOAD_IMAGE_FAILED=7003]="DOWNLOAD_IMAGE_FAILED",e[e.REQUEST_KEY_FAILED=7004]="REQUEST_KEY_FAILED",e[e.SAVE_KEY_STORE_FAILED=7005]="SAVE_KEY_STORE_FAILED",e[e.LOAD_KEY_STORE_FAILED=7006]="LOAD_KEY_STORE_FAILED",e[e.KEY_STORE_NOT_FOUND=7007]="KEY_STORE_NOT_FOUND",e[e.KEY_STORE_BAD_SIZE=7008]="KEY_STORE_BAD_SIZE",e[e.KEY_STORE_BAD_SALT=7010]="KEY_STORE_BAD_SALT",e[e.KEY_STORE_BAD_HMAC=7011]="KEY_STORE_BAD_HMAC",e[e.KEY_STORE_BAD_VERSION=7012]="KEY_STORE_BAD_VERSION",e[e.KEY_STORE_OUT_OF_SYNC=7013]="KEY_STORE_OUT_OF_SYNC",e[e.TOO_MANY_EPISODES=7014]="TOO_MANY_EPISODES",e[e.EPISODE_EXPIRED=7015]="EPISODE_EXPIRED",e[e.SAVE_EPISODE_KEY_STORE_FAILED=7016]="SAVE_EPISODE_KEY_STORE_FAILED",e[e.READ_KEY_STORE_FAILED=7017]="READ_KEY_STORE_FAILED",e[e.DOWNLOAD_HEAD_FILE_FAILED=7018]="DOWNLOAD_HEAD_FILE_FAILED",e[e.DEVICE_LIMIT_REACHED=7028]="DEVICE_LIMIT_REACHED"}(Xa||(Xa={})),function(e){e[e.DOWNLOAD_CAPABILITY=1]="DOWNLOAD_CAPABILITY",e[e.NO_DOWNLOAD_CAPABILITY=2]="NO_DOWNLOAD_CAPABILITY"}(ja||(ja={})),function(e){e[e.DOWNLOADING_ALLOWED=1]="DOWNLOADING_ALLOWED",e[e.DOWNLOADING_NOT_ALLOWED=2]="DOWNLOADING_NOT_ALLOWED"}(za||(za={})),function(e){e.download="download",e.clear="clear",e.notAllowed="notAllowed"}(qa||(qa={}));var Za=n(8172);(0,n(4671).Z)(((e,t)=>({entities:{},connection:Ka.ONLINE,permissions:za.DOWNLOADING_NOT_ALLOWED,setConnection:n=>{e((0,Za.Uy)(t(),(e=>{e.connection=n})))},setPermissions:n=>{e((0,Za.Uy)(t(),(e=>{e.permissions=n})))}})));const Qa=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"}),ei=/\p{White_Space}/u,ti=/\p{P}/u,ni=/\p{sc=Han}/u;function ai(e){return null!==e&&ei.test(e)}function ii(e){return null!==e&&(e<="/"||e>=":"&&e<="@"||"\\"===e||ai(e))}function oi(e){return null!==e&&ti.test(e)}function ri(e){return null!==e&&ni.test(e)}class si{constructor(e,t,n){if(t<0||n<0||t+n>e.length)throw new RangeError;this.data=e,this.offset=t,this.length=n,this.position=0}static from(e){const t=Array.from(e.normalize("NFC"));return new si(t,0,t.length)}toString(){return this.data.slice(this.offset,this.offset+this.length).join("")}slice(e=0,t=this.length){if(e<0||t>this.length)throw new RangeError;const n=this.offset+e,a=t-e;return new si(this.data,n,a)}nextCodePoint(){return this.position===this.length?null:this.data[this.offset+this.position++]}}function li(e){let t;do{t=e.nextCodePoint()}while(null!==t&&ai(t)||oi(t));return t}function di(e,t){let n=li(e),a=li(t);if(null===a)return{offset:0,length:0};const i=e.offset+e.position-1;let o=e.offset+e.position;for(;;){if(null===n&&null===a)return{offset:i,length:o-i};if(null===a)return{offset:i,length:o-i};if(null===n)return null;if(0!==Qa.compare(n,a))return null;o=e.offset+e.position,n=li(e),a=li(t)}}function ci(e,t){let n,a,i;do{a=e.position,n=e.nextCodePoint()}while(null!==n&&ai(n));if(t?.segmentQuotedStrings&&function(e){return null!==e&&('"'===e||"'"===e)}(n)){const t=n;a=e.position;do{i=e.position,n=e.nextCodePoint()}while(null!==n&&n!==t);return null===n&&a===i?null:e.slice(a,i)}do{if(i=e.position,t?.segmentCJKUnifieIdeographs&&ri(n))break;n=e.nextCodePoint()}while(null!==n&&!ii(n));return null===n&&a===i?null:e.slice(a,i)}function ui(e){return ci(e,{segmentQuotedStrings:!0,segmentCJKUnifieIdeographs:!1})}function pi(e){return ci(e,{segmentQuotedStrings:!1,segmentCJKUnifieIdeographs:!0})}function mi(e,t){const n=[];for(let a=pi(e);null!==a;a=pi(e)){let i=di(a,t.slice());null===i?(i=di(e.slice(a.offset),t.slice()),null===i||n.push(i)):n.push(i)}return n}function gi(e,t){return e.offset===t.offset&&e.length===t.length}function hi(e,...t){const n=si.from(e),a=[];for(let e=ui(n);null!==e;e=ui(n)){const n=[];for(let a=0;a<t.length;++a){const i=t[a],o=mi(si.from(i),e);for(const e of o)n.push({text:i,range:e})}if(0===n.length)return null;a.push(...n.filter(((e,t,n)=>e.range.length>0&&n.findIndex((t=>gi(e.range,t.range)))===t)))}return a.length>0?a:null}const Ei="SbHs3Uu1EU0cmvhxoTNE",_i="XagfkHHUPIC2O6Q_lfEw",Si=(e,t)=>"string"==typeof e&&"string"==typeof t?!(e.length>0)||null!==hi(e,t):"boolean"!=typeof e||e,fi=({filter:e,title:t})=>{const n=(0,s.useCallback)((({searchWords:[e],textToHighlight:t})=>e?(hi(e,t)||[]).map((e=>({start:e.range.offset,end:e.range.offset+e.range.length}))):[]),[]);return s.createElement(wn.Dy,{as:"h2",variant:"cello",className:_i,semanticColor:"textBase"},"string"==typeof e&&e.length>0?s.createElement(Pn(),{searchWords:[e],textToHighlight:t,findChunks:n,highlightClassName:Ei}):t)},bi=({filter:e,title:t,children:n,rows:a})=>{const i=Si(e,t);if("ALLOW_NULL_ROWS"===a)return i?s.createElement(s.Fragment,null,s.createElement(fi,{filter:e,title:t}),n):null;const o=i?a:a.filter((e=>e&&Si(e?.props.filter,e?.props.title)));return o.length>0?s.createElement(s.Fragment,null,s.createElement(fi,{filter:e,title:t}),o,n):null};var ki=n(6501);const Ai={horizontalPair:"QdHLUcR6fUG0NMpMpxbQ",ProxySettings:"PM2eBojuLDjs3wM2jY6x",fullWidth:"V0tNwwnJHzwFrLYFSVhn",proxyInput:"aQJknW_LvVUnrcdJNXVA",labelStretch:"iXaZ29sMMazjjRS1_MGy",restartAppButton:"yItjEPzHEmxYuEoTJJBl",title:"HkLDZG7BHRMlXcxLOlBd",ProxyFormGroup:"ZUltXmAUnMFuWM6kgOQo"},Ti=({id:e,type:t,placeHolder:n,inputRef:a,handleOnChange:i})=>s.createElement("input",{type:t||"text",id:e,"data-testid":e,className:Ai.proxyInput,placeholder:n,ref:a,onChange:i}),Ni=({children:e,label:t})=>s.createElement(ki.cw,{label:t,className:Ai.ProxyFormGroup},e),yi=(e,t,n)=>{let a=`${e}:${t}`;switch(n){case pt:a+="@http";break;case mt:a+="@socks4";break;case gt:a+="@socks5"}return a},Ii=({addr:e,mode:t,pass:n,user:a,setValue:i,restartContainer:o,fullWidth:r,filter:l})=>{const d=(0,s.useRef)(null),c=(0,s.useRef)(null),u=(0,s.useRef)(null),p=(0,s.useRef)(null),[m,g]=(0,s.useState)(""),[h,E]=(0,s.useState)(""),[_,S]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const[t,n]=e?.split(/[:@]+/)||["",""];g(t),E(n),d.current&&(d.current.value=t),c.current&&(c.current.value=n)}),[e]),(0,s.useEffect)((()=>{p.current&&n&&(p.current.value=n.toString())}),[n]),(0,s.useEffect)((()=>{u.current&&a&&(u.current.value=a.toString())}),[a]);const f=(0,s.useCallback)((({target:e})=>{const n=yi(e.value,h,t||0);g(e.value),i("network.proxy.addr",n),S(!0)}),[t,h,i]),b=(0,s.useCallback)((({target:e})=>{const n=yi(m,e.value,t||0);E(e.value),i("network.proxy.addr",n),S(!0)}),[t,m,i]),k=(0,s.useCallback)((({target:e})=>{i("network.proxy.user",e.value),S(!0)}),[i]),A=(0,s.useCallback)((({target:e})=>{i("network.proxy.pass",e.value),S(!0)}),[i]),T=0!==t&&1!==t,N=t!==mt;return s.createElement(bi,{rows:"ALLOW_NULL_ROWS",filter:l,title:ut.get("desktop.settings.proxy.title")},s.createElement("div",{className:Gt()(Ai.ProxySettings,r?Ai.fullWidth:null)},s.createElement(Ni,{label:ut.get("desktop.settings.proxy.type")},s.createElement(vn,{className:Ai.secondColumn,id:"network.proxy.mode",value:t,onSelect:e=>{const t=parseInt(e,10);i("network.proxy.mode",t),S(!0)}},Et.map((({enumKey:e,enumValue:t})=>s.createElement("option",{key:e,value:t,"data-testid":e},ht[e]?ht[e].label():""))))),T?s.createElement(s.Fragment,null,s.createElement("div",{className:Ai.horizontalPair},s.createElement(Ni,{label:ut.get("desktop.settings.proxy.host")},s.createElement(Ti,{id:"network.proxy.host",handleOnChange:f,placeHolder:ut.get("desktop.settings.proxy.host"),inputRef:d})),s.createElement(Ni,{label:ut.get("desktop.settings.proxy.port")},s.createElement(Ti,{id:"network.proxy.port",type:"number",handleOnChange:b,placeHolder:ut.get("desktop.settings.proxy.port"),inputRef:c}))),s.createElement("div",{className:N?Ai.horizontalPair:void 0},s.createElement(Ni,{label:ut.get("desktop.settings.proxy.user")},s.createElement(Ti,{id:"network.proxy.user",handleOnChange:k,placeHolder:ut.get("desktop.settings.proxy.user"),inputRef:u})),N?s.createElement(Ni,{label:ut.get("desktop.settings.proxy.pass")},s.createElement(Ti,{id:"network.proxy.pass",handleOnChange:A,placeHolder:ut.get("desktop.settings.proxy.pass"),type:"password",inputRef:p})):null)):null,_&&s.createElement("div",null,s.createElement(Cn.P,{buttonSize:"sm",className:Ai.restartAppButton,onClick:o},ut.get("settings.restartApp")))))},Di=["network.proxy.mode","network.proxy.addr","network.proxy.user","network.proxy.pass"];const Ci=(0,c.$j)((e=>({settings:{proxy:e.settings.proxy}})),(e=>({fetchProxySettings(){e(Dt.fetchProxySettings())},updateProxySettings(t){e(Dt.updateProxySettings(t))},restartClient(){e(Dt.restartClient())}})))((({settings:e={proxy:{mode:0,address:"",username:"",password:""}},fetchProxySettings:t=(()=>{}),updateProxySettings:n=(()=>{}),restartClient:a=(()=>{})})=>{(0,s.useEffect)((()=>{t()}),[t]);const i=(0,s.useCallback)(((t,a)=>{if(function(e){return!!Di.includes(e)}(t)){const i={...e.proxy};switch(t){case"network.proxy.mode":i.mode=a;break;case"network.proxy.addr":i.address=a;break;case"network.proxy.user":i.username=a;break;case"network.proxy.pass":i.password=a}n(i)}return Promise.resolve()}),[e,n]);return s.createElement("main",{className:"Settings","aria-labelledby":"settings-form-title","data-testid":"settings"},s.createElement("h1",{className:"HeroText",id:"settings-form-title"},ut.get("desktop.login.PreferencesLink")),s.createElement(Ii,{mode:e.proxy.mode,addr:e.proxy.address,user:e.proxy.username,pass:e.proxy.password,setValue:i,restartContainer:a,fullWidth:!0}))}));class Oi extends s.PureComponent{constructor(e){super(e),this.handleSettingsClick=this.goToSettingsPage.bind(this),this.handleBackToLoginClick=this.handleBackToLoginClick.bind(this)}handleSignupClick(){const{openSignupPage:e,onInteraction:t}=this.props,n=Lt();e(n),t("login/welcome","click","open-page-signup",null,n)}handleBackToLoginClick(e){e.preventDefault(),this.props.openLoginPage(),this.props.onInteraction(this.props.mode,"click","back-to-login")}goToSettingsPage(e){e.preventDefault(),this.props.openSettingsPage(),this.props.onInteraction(this.props.mode,"click","open-page-settings")}renderPreferencesLink(){return s.createElement("a",{className:"Footer__link",href:"#",onClick:this.handleSettingsClick,"data-ta-id":"login-footer-settings"},ut.get("desktop.login.PreferencesLink"))}renderBackToLoginLink(){return s.createElement("a",{className:"Footer__link",href:"#",onClick:this.handleBackToLoginClick,"data-ta-id":"login-footer-settings-back-to-login"},ut.get("desktop.login.Back"))}renderTryAgain(){return s.createElement(s.Fragment,null,s.createElement("span",null,ut.get("desktop-auth.login.not-seeing-browser"))," ",s.createElement("a",{href:"#",onClick:()=>this.props.tryAgainHandler()},ut.get("desktop-auth.login.try-again")))}renderSignupLink(){return s.createElement("a",{className:"Footer__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignupClick(),"data-ta-id":"welcome-signup-link",dangerouslySetInnerHTML:{__html:ut.get("desktop.login.DontHaveAnAccountSignup")}})}renderRussiaLegalFormLink(){return s.createElement("div",null,s.createElement("a",{className:"Footer__link",href:"https://support.spotify.com/ru-ru/contact-spotify-legal-form/",target:"_blank",rel:"noopener"},"Форма для Ваших обращений"))}render(){const{mode:e,country:t}=this.props;return s.createElement("footer",{className:"Footer",role:"contentinfo"},"login"===e&&this.renderPreferencesLink(),"settings"===e&&this.renderBackToLoginLink(),"open-browser"===e&&this.renderTryAgain(),"welcome"===e&&this.renderSignupLink(),"RU"===t&&this.renderRussiaLegalFormLink())}}const vi=(0,c.$j)((e=>({country:e.signup.restrictions?.country})),(e=>({tryAgainHandler:()=>{e(Dt.abortLoginWithAccounts()),e(Dt.enterWelcomeMode())},openLoginPage:()=>{e(Dt.enterLoginMode())},openSignupPage:t=>e(Dt.enterSignupMode(t)),openSettingsPage:()=>e(Dt.enterSettingsMode()),onInteraction:(t,n,a,i,o)=>e(Dt.interaction(t,n,a,i,o))})))(Oi);class Li extends s.PureComponent{render(){return s.createElement("header",{className:"Header"},s.createElement("h1",{className:"glue-hidden-visually"},"Spotify"),s.createElement("img",{className:"Header__logo",src:"images/logo.svg",alt:""}))}}var Pi=n(1226),wi=n(5989);class Fi extends s.Component{static defaultProps={throbberDelay:0,transitionLeaveTimeout:0};renderFakeWebPlayer(){return s.createElement("div",{className:"fakeWebPlayer"},s.createElement("aside",null),s.createElement("footer",null,s.createElement("div",{className:"fakeWebPlayer__footer-left"}),s.createElement("div",{className:"fakeWebPlayer__footer-center"}),s.createElement("div",{className:"fakeWebPlayer__footer-right"})),s.createElement("main",null,s.createElement("div",{className:"fakeWebPlayer__content"})))}render(){const{loading:e,mode:t,loggedIn:n,previousMode:a,throbberDelay:i,signupStep:o,previousSignupStep:r}=this.props;if(e||!t)return s.createElement(Ct,{delay:i});if(n)return null;let l=a?`__${t} __${a}-to-${t}`:"";return"signup"===t&&Number.isInteger(r)&&(l+=` __signup_step_${r}_to_${o}`),s.createElement("main",{className:"App",key:"main1","data-ta-id":"login-app","data-testid":"login-app","data-ta-login-mode":t},this.renderFakeWebPlayer(),s.createElement("div",{className:`App__content ${l}`},s.createElement(wi.Z,{mode:"in-out"},s.createElement(Pi.Z,{timeout:{appear:0,enter:0,exit:650},key:l},s.createElement("div",{className:`App__modal ${l}`},s.createElement(Li,null),"welcome"===t&&s.createElement(Rt,null),"signup"===t&&s.createElement(fn,{step:o}),"login"===t&&s.createElement(yn,null),"open-browser"===t&&s.createElement(Dn,null),"settings"===t&&s.createElement(Ci,null),s.createElement(vi,{mode:t}))))))}}const Ri=(0,c.$j)((e=>({mode:e.app.mode,previousMode:e.app.previousMode,signupStep:e.signup.step,previousSignupStep:e.signup.previousStep,loading:!!e.login.loading,loggedIn:!!e.login.loggedIn,throbberDelay:e.login.throbberDelay,transitionLeaveTimeout:e.login.redirectDelay})))(Fi);var Mi=n(3828),Ui=n(3894);const xi=e=>t=>n=>{const a=t(n);switch(n.type){case Dt.START_APP:e.dispatch(Dt.fetchUTMParameters()),e.dispatch(Dt.getSignupRestrictions());!B.getItem("lastUsername")?e.dispatch(Dt.enterWelcomeMode()):e.dispatch(Dt.enterLoginMode());break;case Dt.LOGIN_FAIL:{const t=e.getState();if(n.loginType===Dt.LOGIN_TYPE_AUTOLOGIN){const n=t.app.mode;"welcome"===n?e.dispatch(Dt.enterWelcomeMode()):"login"===n?e.dispatch(Dt.enterLoginMode()):"signup"===n&&e.dispatch(Dt.enterSignupMode())}else{if("open-browser"===t.app.mode){const a=n.errorData;let i=Wt(a.errorCategory,a.errorCode,a.errorReference);"desktop_login_accounts"===a.errorCategory&&4===a.errorCode&&(i="signup"===t.experimentWebAuthReducer.operationUsed?ut.get("desktop-auth.login.signup-time-out"):ut.get("desktop-auth.login.login-time-out")),i?e.dispatch(Dt.enterWelcomeMode(i)):e.dispatch(Dt.enterWelcomeMode())}}break}case Dt.ENTER_SIGNUP_MODE:{const t=e.getState().signup.restrictions;t?!1===t.is_country_launched&&e.dispatch(Dt.countryNotLaunched()):e.dispatch(Dt.getSignupRestrictions());break}case Dt.SIGNUP_RESTRICTIONS_SUCCESS:!1===n.restrictions.is_country_launched&&e.dispatch(Dt.countryNotLaunched());break;case Dt.SIGNUP_FAILURE:(n.errors.email||n.errors.password||n.errors.displayname)&&e.dispatch(Dt.enterSignupModeStep0());break;case Dt.COUNTRY_NOT_LAUNCHED:e.dispatch(Dt.openSignupPage(!0))}return a};var Bi=n(9798);const Gi=vt().create().toString(),Wi="has-used-app",Vi=!window.localStorage.getItem(Wi);Vi&&window.localStorage.setItem(Wi,!0);const Hi=()=>{const e=B.getItem("utmParameters");let t;try{t=e?JSON.parse(e).referral:""}catch(e){t=""}return t};class Yi{constructor(e){this._eventSender=e}logPageView({page:e}){this.logAction({page:e,action_type:"pageview",action_intent:""})}logAction({page:e,action_type:t,action_intent:n,item_id:a,action_hash:i}){this._eventSender.send((0,Bi.e)({action_type:t,action_intent:n,action_page:e,action_item_id:a,action_hash:i,device_is_new_install:Vi,device_locale:window.__spotify.locale,device_referrer:Hi(),ab_flags:"",session_id:Gi}))}}const Ji=e=>{window.location.href=e},Ki=()=>e=>t=>{const n=e(t);if(!t.redirectTo)return n;let a;return"xpui"!==t.redirectTo||(a="spotify:app:xpui",t.redirectDelay?setTimeout((()=>{Ji(a)}),t.redirectDelay):Ji(a)),n},$i={errorMessage:null};const Xi=function(e=$i,t){switch(t.type){case Dt.ENTER_SIGNUP_MODE:return{...e,previousMode:e.mode,mode:"signup"};case Dt.ENTER_LOGIN_MODE:case Dt.COUNTRY_NOT_LAUNCHED:return{...e,previousMode:e.mode,mode:"login"};case Dt.ENTER_WELCOME_MODE:return{...e,previousMode:e.mode,mode:"welcome",errorMessage:t.errorMessage??null};case Dt.ENTER_SETTINGS_MODE:return{...e,previousMode:e.mode,mode:"settings"};default:return e}};const ji={proxy:{mode:0,address:"",username:"",password:""}};const zi=function(e=ji,t){return function(e){return e.type===Dt.SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS}(t)?{...e,proxy:{mode:t.data.mode,address:t.data.address,username:t.data.username,password:t.data.password}}:e},qi={step:0,isAttempting:!1,isSuccessful:void 0,errors:{},errorData:{},validated:{},formData:{name:"",email:"",password:"",birthDate:{day:void 0,month:void 0,year:void 0},gender:void 0,sendEmail:void 0,shareData:void 0,agreeEula:!1},restrictions:void 0};const Zi=function(e=qi,t){switch(t.type){case Dt.ENTER_SIGNUP_MODE_STEP_0:return{...e,previousStep:e.step,step:0};case Dt.ENTER_SIGNUP_MODE_STEP_1:return{...e,previousStep:e.step,step:1};case Dt.SIGNUP_RESTRICTIONS_SUCCESS:return{...e,formData:{...e.formData,sendEmail:!!t.restrictions.requires_marketing_opt_in_text||void 0,agreeEula:!!t.restrictions.pretick_eula},restrictions:t.restrictions};case Dt.SIGNUP_RESTRICTIONS_FAILURE:return{...e,errorData:t.error};case Dt.SIGNUP_ATTEMPT:return{...e,isAttempting:!0,errorData:null};case Dt.SIGNUP_SUCCESS:return{...e,isAttempting:!0,isSuccessful:!0,errorData:null};case Dt.SIGNUP_FAILURE:return{...e,isAttempting:!1,isSuccessful:!1,errors:t.errors,errorData:null};case Dt.FACEBOOK_SIGNUP_ATTEMPT:return{...e,errorData:null,errors:{}};case Dt.FACEBOOK_SIGNUP_FAILURE:return{...e,errorData:t.errorData};case Dt.VALIDATE_FIELD_ATTEMPT:return{...e,errors:{...e.errors,[t.field]:void 0}};case Dt.VALIDATE_FIELD_FAILURE:return{...e,errors:{...e.errors,[t.field]:t.error},validated:{...e.validated,[t.field]:!1}};case Dt.VALIDATE_FIELD_SUCCESS:return{...e,errors:{...e.errors,[t.field]:void 0},validated:{...e.validated,[t.field]:!0}};case Dt.UPDATE_SIGNUP_DATA:{const n={};for(const e of Object.keys(t.data))n[e]=void 0;return{...e,errors:{...e.errors,...n},formData:{...e.formData,...t.data}}}case Dt.CLEAR_ALL_ERRORS:return{...e,errors:{}};default:return e}};function Qi(e){const t=(0,Mi.MT)((0,Mi.UY)({app:Xi,login:K,settings:zi,signup:Zi}),void 0,(0,Mi.md)(Ui.Z,xi,(e=>{const t=new Yi(e);return()=>e=>n=>{const a=e(n);switch(n.type){case Dt.ENTER_LOGIN_MODE:t.logPageView({page:"login"});break;case Dt.LOGIN_SUCCESS:n.loginType===Dt.LOGIN_TYPE_EMAIL?t.logAction({page:"login",action_type:"view",action_intent:"show-success-login-email"}):n.loginType===Dt.LOGIN_TYPE_FACEBOOK&&t.logAction({page:"login",action_type:"view",action_intent:"show-success-login-facebook"});break;case Dt.LOGIN_FAIL:n.loginType===Dt.LOGIN_TYPE_EMAIL?n.errorData&&3===n.errorData.errorCode&&t.logAction({page:"login",action_type:"view",action_intent:"show-error-invalid-credential"}):n.loginType===Dt.LOGIN_TYPE_FACEBOOK&&t.logAction({page:"login",action_type:"view",action_intent:"show-error-login-facebook"});break;case Dt.ENTER_SIGNUP_MODE:t.logPageView({page:"signup"});break;case Dt.ENTER_SIGNUP_MODE_STEP_0:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-one"});break;case Dt.ENTER_SIGNUP_MODE_STEP_1:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-two"});break;case Dt.SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-signup-email"});break;case Dt.SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-signup-email",item_id:n.errors&&Object.keys(n.errors).join("|")});break;case Dt.FACEBOOK_SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-authentication-facebook"});break;case Dt.FACEBOOK_SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-authentication-facebook",item_id:n.errorData&&`${n.errorData.errorCode} - ${n.errorData.errorDescription}`});break;case Dt.ENTER_WELCOME_MODE:t.logPageView({page:"login/welcome"});break;case Dt.ENTER_SETTINGS_MODE:t.logPageView({page:"login/settings"});break;case Dt.INTERACTION:t.logAction({page:n.page,action_type:n.interactionType,action_intent:n.intent,item_id:n.itemId,action_hash:n.actionHash});break;case Dt.VALIDATE_FIELD_FAILURE:if(n.error){const e=n.field,a=n.error.code;let i=null,o=null;"valueMissing"===a?i=`show-error-empty-${e}`:["incomplete","invalid","typeMismatch","tooShort"].includes(a)?i=`show-error-format-${e}`:(i=`show-error-${e}`,o=n.error.message||""),null!==i&&t.logAction({page:"signup",action_type:"view",action_intent:i,...o?{item_id:o}:{}})}}return a}})(e),Ki));return t.subscribe((()=>{const e=t.getState();e.login.username&&localStorage.setItem(G,e.login.username),e.login.utmParameters&&localStorage.setItem(V,JSON.stringify(e.login.utmParameters))})),t}var eo=n(2585),to=n(9466);let no=null;var ao=n(1076),io=n(6471);(async function(){for(const e of[window.__spotify.locale,ot.en])try{const t=await fetch(`i18n/${e}.json`).then((e=>e.json()));return ut.setLocale(e),void ut.setDictionary(t)}catch(e){0}throw new Error("Cannot find a suitable locale! Something is wrong: talk to #desktop.")})().then((async function(){const e=function(){const e=(0,to.createBaseTransport)({providers:{endpoints:(0,to.createXResolveProvider)(),token:()=>null}});return e.connect(),e}();no=e;const t=((e,t,n)=>{const a=e.event_sender_context_information,i=[(0,io.UR)({version:a.client_version_string}),(0,io.jx)(n),(0,io.IE)(a.installation_id),(0,io.Hv)({name:a.platform_type,version:a.os_version}),(0,io.yD)({manufacturer:a.device_manufacturer||"",model:a.device_model||""})];return(0,ao.mi)({transport:t,suppressPersist:!1,context:i})})(window.__spotify,e,"65b708073fc0480ea92a077233ca87bd"),n=Qi(t);p.attach(),p.update(),u.attach();const a=document.location.search,i=new RegExp(`\\?param=error-code\\${encodeURIComponent("=")}([0-9]+)`,"i");window.addEventListener("message",(e=>{"critical-update-error"===e.data&&n.dispatch(Dt.loginFailed({errorCode:e.data}))}));const o=a.match(i);if(a&&o){const e=+o[1];n.dispatch(Dt.loginFailed({errorCode:e}))}let r="linux";window.navigator.platform.startsWith("Mac")&&(r="mac"),window.navigator.platform.startsWith("Win")&&(r="windows"),document.body.classList.add(`body-container--${r}`),l.render(s.createElement(d.zj,null,s.createElement(c.zt,{store:n},s.createElement(Ri,null))),document.getElementById("main")),n.dispatch(Dt.startApp()),document.documentElement.setAttribute("dir",window.__spotify.localization_is_rtl?"rtl":"ltr");const m={[eo.PLATFORM_UNKNOWN]:"body-container--unknown-os",[eo.PLATFORM_MAC]:"body-container--mac",[eo.PLATFORM_WINDOWS]:"body-container--windows"},g=(0,eo.getPlatform)();document.body.classList.add(m[g])}))},2585:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PLATFORM_MAC:()=>i,PLATFORM_UNKNOWN:()=>a,PLATFORM_WINDOWS:()=>o,getPlatform:()=>l,isMac:()=>r,isWindows:()=>s});const a=Symbol("PLATFORM_UNKNOWN"),i=Symbol("PLATFORM_MAC"),o=Symbol("PLATFORM_WINDOWS");function r(){return window.navigator.platform.startsWith("Mac")}function s(){return window.navigator.platform.startsWith("Win")}function l(){return r()?i:s()?o:a}},2976:(e,t)=>{let n=!1;t.update=()=>{},t.attach=()=>{if(n)return;n=!0;const e=window.__spotify&&window.__spotify.locale;e&&document.documentElement.setAttribute("lang",e)},t.detach=()=>{n&&(n=!1,document.documentElement.removeAttribute("lang"))}},685:(e,t,n)=>{const{getPlatform:a,PLATFORM_UNKNOWN:i,PLATFORM_MAC:o,PLATFORM_WINDOWS:r}=n(2585);let s=!1,l="always-visible",d=0;const c={[i]:"linux",[o]:"mac",[r]:"windows"};let u=c[i];function p(){const e=[...document.querySelectorAll("*")],t=[],n=["scroll","auto","overlay"];e.forEach((e=>{const a=window.getComputedStyle(e),i=a.overflowX,o=a.overflowY;n.includes(i)&&t.push({node:e,property:"overflow-x"}),n.includes(o)&&t.push({node:e,property:"overflow-y"})}));const a=document.createElement("style");a.innerHTML="\n    html::-webkit-scrollbar,\n    body::-webkit-scrollbar {\n      background-color: rgba(1, 2, 3, 0) !important;\n    }\n  ".trimRight();const i=`data-scrollbar-fix-${++d}-id`;let o=0;t.forEach((({node:e,property:t})=>{if(e!==document.body){const n=++o;e.setAttribute(i,n),a.innerHTML+=`\n    [${i}="${n}"] { ${t}: hidden !important; }`}})),document.head.appendChild(a),setTimeout((()=>{document.head.removeChild(a),t.forEach((({node:e})=>{e.removeAttribute(i)}))}),0)}t.performScrollBarFix=p,t.update=function(){},t.attach=function(){if(s)return;s=!0;const e=window.__spotify&&window.__spotify.scroller_style;l="overlay"===e?"overlay":"always-visible";const t=a();u=c[t],"always-visible"===l||"mac"!==u?(document.body.classList.remove("scrollbar-style-when-scrolling-mac"),document.body.classList.add(`scrollbar-style-visible-${u}`)):(document.body.classList.remove(`scrollbar-style-visible-${u}`),document.body.classList.add("scrollbar-style-when-scrolling-mac")),window.addEventListener("message",(e=>{"set_active"===e.data.name&&e.data.active&&p()}))},t.detach=function(){s&&(s=!1,d=0)}}},n={};function a(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={exports:{}};return t[e].call(o.exports,o,o.exports,a),o.exports}a.m=t,a.amdO={},e=[],a.O=(t,n,i,o)=>{if(!n){var r=1/0;for(c=0;c<e.length;c++){for(var[n,i,o]=e[c],s=!0,l=0;l<n.length;l++)(!1&o||r>=o)&&Object.keys(a.O).every((e=>a.O[e](n[l])))?n.splice(l--,1):(s=!1,o<r&&(r=o));if(s){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,i,o]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={535:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[r,s,l]=n,d=0;if(r.some((t=>0!==e[t]))){for(i in s)a.o(s,i)&&(a.m[i]=s[i]);if(l)var c=l(a)}for(t&&t(n);d<r.length;d++)o=r[d],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},n=("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=a.O(void 0,[569],(()=>a(2253)));i=a.O(i)})();
//# sourceMappingURL=login.js.map